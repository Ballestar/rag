00:00:00.730 - 00:00:26.178, Speaker A: Now let's talk in more detail about this extremely important mining process that happens in Bitcoin. And remember, mining really is accomplishing two different goals at once. So foremost it's answering the question who authorizes transactions and how does that happen? So these miners are going to be solving these hard cryptographic puzzles that will give them the privilege of adding a new block of transactions to the blockchain and for which they will be be rewarded.
00:00:26.178 - 00:01:01.506, Speaker A: And then the second question this also answers is where do bitcoins come from? Who mints the money? So every time a new block is added to the blockchain, new bitcoins get created to be given to the miner of that block as a reward. So to explain exactly how this proof of work works, what are these hard cryptographic puzzles I need to explain? What do I mean by a cryptographic hash function? Well, you should think about a cryptographic hash function as like an inscrutable black box. And so Bitcoin uses a specific black box which goes by the name Sha 256.
00:01:01.506 - 00:01:16.850, Speaker A: And so what does this black box do? Well, you feed it as many bits as you want. You can feed it your Social Security number, your name or your address or your public key, whatever. It's happy to accept anything as input.
00:01:16.850 - 00:01:35.478, Speaker A: So what do you get back in return? You get back a bunch of gobbledygook, a bunch of zeros and ones that seems to have no structure at all, that seems as if it was just chosen by a deity uniformly at random from the universe. Shot 256. The 256 refers to the number of bits of output.
00:01:35.478 - 00:02:03.086, Speaker A: So whatever you feed into shot 256 doesn't matter if it's a long string or a short string of bits, doesn't matter what it's going to output is 256 zeros and ones in which you will not be able to find any structure, any patterns at all. Now, it shouldn't be obvious to you that cryptographic hash functions exist. Maybe you think that any program that a human could conceivably write down would inevitably generate sort of biases, sort of detectable patterns in the output.
00:02:03.086 - 00:02:26.954, Speaker A: And to be honest, we don't scientifically fully know the answer to that question, whether these exist or not. But people have certainly come up with functions that act like cryptographic hash, functions that appear to have no patterns whatsoever. Sha 256 being a good example, and actually I encourage you to, if you just do a Google search for Sha 256, you'll be able to find the code or the code is even on Wikipedia, I think it's not that long.
00:02:26.954 - 00:02:50.186, Speaker A: You can just read through the code for the function and then you can find websites that will just evaluate the shot 256 on whatever input you want. And what's fun is to type in a string like hello world, see what shot 256 is and then just add like a period to the end of hello world and all of a sudden the output of shot 256 is like totally different. Like everything changes just because you added one period.
00:02:50.186 - 00:03:06.710, Speaker A: So that's what I mean by sort of the output of shot 256. It just seems to have no patterns. All practical purposes, indistinguishable from just a totally random function that just flips 256 coins in a row and tells you the sequence of heads and tails that you've got to develop.
00:03:06.710 - 00:03:39.250, Speaker A: Our intuition, let's suppose for the moment that Sha 256 literally was a random function. That literally the way it generated its output is it just ignored whatever the input was flipped a fair coin 256 times in a row and output a zero whenever there was a heads and a tail and a one whenever there was a tails. Now, whatever it is that you feed into a random function like that, you'd have to get pretty lucky to get heads 256 times in a row to get an output of all zeros.
00:03:39.250 - 00:03:51.398, Speaker A: That's a very unlikely event. Literally if everybody in existence flipped all the coins we had until the end of time, you would probably not get 256 heads in a row. That's how unlikely it is.
00:03:51.398 - 00:04:33.166, Speaker A: And continuing that idea, suppose you were like, okay, well, let's say I'm going to be happy even if just the last 80 coin flips are all heads, so the first 176 coin flips can be whatever, but the last 80 should be heads should be zeros. Well, the probability of that is two to the -80 which again is not quite as unlikely but is very very hard to do two to the -80 is a very very small probability of something succeeding. But that tiny probability that two to the -80 probability that is in fact the probability of a given miner getting lucky and being allowed to authorize a given block proposal to the blockchain.
00:04:33.166 - 00:04:56.854, Speaker A: So that's why it's a proof of work it is very hard to find a block that will give you 80 trailing zeros after you feed it through the Sha 256 cryptographic hash function. But that is exactly what miners have to do to earn the privilege of adding a block to the blockchain and getting the corresponding reward. So the language we'll use is we'll call potential blocks.
00:04:56.854 - 00:05:30.882, Speaker A: Remember what a block contains, it has all of the transactions, it sort of points to the previous block and then it also has this nonce which is actually going to come into play shortly. So a block has the transactions, the predecessor block and the nonce, and we're going to call it eligible if when you feed the description of the block, okay, so you're going to say what the block is all the transactions, what the order of the transactions are, what your nonsense, et cetera. So you take this description of your block if you feed it into shot 256 and the result starts with a sequence of 80 zeros, which again is very unlikely.
00:05:30.882 - 00:05:57.594, Speaker A: But if that happens if your block is such that the output of Sha 256 starts with 80 zeros, then we will call your block eligible, eligible for inclusion in the blockchain. I'm hiding a couple of details. So like this 80, that's sort of a magic number that gets adjusted over time depending on how many miners are sort of participating and how much computational power they're spending trying to solve these cryptographic hash puzzles.
00:05:57.594 - 00:06:07.694, Speaker A: Also, technically, it's not shot 256. You apply shot 256 twice, seemingly for good luck, but otherwise this is accurate. This is what it means for a block to be eligible.
00:06:07.694 - 00:06:24.018, Speaker A: It starts with a long sequence of zeros, which is in general very unlikely. So what does it actually mean when you're a bitcoin miner? It means you've got computers, you've got machines. And what they're trying to do is they're trying to find an eligible block.
00:06:24.018 - 00:06:44.266, Speaker A: So they are trying different choices of the block b until they finally get lucky and they find the block which is eligible. A block whose hash starts with a long sequence of zeros. In the happy event that you actually do put together a block that starts with that many zeros, that you find an eligible block, you of course don't want to keep it a secret.
00:06:44.266 - 00:07:00.526, Speaker A: You want everybody to know that you really did solve this, in effect, super hard sudoku puzzle. So you broadcast this block to everyone else in the peer to peer network so that they find out about it. And then once everybody has learned about your newly authorized block, that gets added to the ledger.
00:07:00.526 - 00:07:08.418, Speaker A: So that is how a block finally gets added to the blockchain. You've broadcast it so everybody knows that indeed it should be added. Everybody can check that it really is eligible.
00:07:08.418 - 00:07:20.602, Speaker A: And so that's the new block on the blockchain. Now, because the probability of a success is so small, you have to try a lot of times before you're going to find an eligible block. And that's hard work.
00:07:20.602 - 00:07:39.294, Speaker A: So you're going to have to buy computers, buy machines, pay for energy to run those machines. And so accordingly, miners are incentivized to do this difficult work. And this is the part of the protocol which really exploits the fact that it has a native currency, that there are bitcoins that it can just print from thin air.
00:07:39.294 - 00:07:54.660, Speaker A: And the reward currently to a miner who successfully authorizes a new block and adds it to the blockchain is 6.25 bitcoins. So remembering that a bitcoin is hovering around $10,000 right now, that would be $62,000.
00:07:54.660 - 00:08:09.794, Speaker A: If your lottery ticket cashes out, you get an eligible block and you add it to the blockchain. So no small chunk of change, $62,000. And in fact, you might remember back when we first started talking about transactions, one of the things a transaction includes is a transaction fee.
00:08:09.794 - 00:08:22.682, Speaker A: And I told you at that time that that was going to be a transfer of funds from the sender. So the person who created the transaction to whoever authorized the transaction at that time, it wasn't clear who was authorizing it. Now we see who's authorizing it.
00:08:22.682 - 00:08:44.014, Speaker A: So if a minor finds an eligible block and includes your transaction in that eligible block, that is what authorizes your transaction. And so it is this minor, this miner, that adds this block to the blockchain that's going to be the recipient of that transaction fee. Now, for most of bitcoin's life, the transaction fees have been well smaller than what's called the block reward.
00:08:44.014 - 00:08:56.882, Speaker A: This 6.25 bitcoins, meaning only 10% as big as the block reward, or even only 1% as big as the block reward, depending on the moment in time. So to first order, we can sort of ignore the transaction fees.
00:08:56.882 - 00:09:10.394, Speaker A: They're kind of like a little tip on top of the more substantial six and a quarter bitcoins block reward. Notice the difference between these two, the 6.25, those are new bitcoins created out of thin air.
00:09:10.394 - 00:09:27.922, Speaker A: So those are not a transfer. That's literally new money that's been created, whereas the transaction fees, that does not create any new money, right? So that was money that used to belong to the originator of the transaction, and that's just getting transferred to the miner. One little detail is this block reward, the 6.25,
00:09:27.922 - 00:09:41.650, Speaker A: this number actually gets cut in half every four years and actually just got cut in half a month ago in June 2020. So it was a long time ago. It was 50 bitcoins per block.
00:09:41.650 - 00:09:51.366, Speaker A: I think when I first found out about bitcoin, it had dropped to 25 bitcoins per block. For a while there was twelve and a half, and now it's six and a quarter. And then in 2024, it's going to half.
00:09:51.366 - 00:10:06.190, Speaker A: Once again, the final thing I want to say about mining is just a little bit. Where do this 80 zeros come from? And I mentioned that that 80 gets adjusted according to what miners are doing. So let me tell you a little bit about that difficulty adjustment algorithm.
00:10:06.190 - 00:10:19.034, Speaker A: Here's the mental model you should have about a minor. And this really is how miners do this in practice, right? So you're trying to find an eligible block. You're trying to find something that when you hit it with shot 256 twice, you get a whole bunch of zeros at the beginning.
00:10:19.034 - 00:10:28.678, Speaker A: So you got to try all these different blocks. So the way people usually do this is they just sort of pick some set of transactions. They fix, fix that, you've got the name of the previous block, you fix that.
00:10:28.678 - 00:10:43.014, Speaker A: And then remember, there is that nonce, there is the gobbledygook. You were allowed to put inside the block the number used once, and that's what you play around with. So you keep the transactions fixed, you keep the name of the previous block fixed, and you just try, in effect, random possibilities.
00:10:43.014 - 00:11:15.330, Speaker A: Or you try one by one different possibilities. For that nonce, hoping that at some point you find the magical nonce that results in the double application of shot 256 giving you a bunch of zeros in a row. And something that's not proved mathematically, but is sort of believed to be true mathematically and certainly as far as practice is true, is that basically there's no way to solve these crypto puzzles faster than just sort of random guessing, than just sort of trying possibilities, because there's no structure that we can discern in this function.
00:11:15.330 - 00:11:56.050, Speaker A: There's really no clever shortcuts over trying a bunch of possibilities feeding into the function when you're looking for something with 80 zeros at the beginning. And so what that means if you're just sort of randomly guessing stuff and you're just getting these random outputs from shot 256 then the chance of one of those guesses working of getting 80 zeros at the beginning, 80 heads in a row, that's going to be two to the -80 really small probability. And so you don't really expect that to happen until you've done roughly two to the 80 trials, two to the 80 trials, each one is a two to the -80 probability of succeeding at that point you've got a decent shot that at least once you will have seen 80 heads in a row.
00:11:56.050 - 00:12:26.214, Speaker A: And so why is it set to 80? Why not to some other number? Well, the 80 comes from is that the Bitcoin protocol shoots for a target rate at which new blocks are created, at which miners find new eligible blocks. And so what Bitcoin is doing is it's adjusting this number 80 until given the rate at which miners are trying different possibilities in expectation, there's ten minutes between successive blocks. So that's how this 80 is chosen.
00:12:26.214 - 00:12:40.410, Speaker A: A minor is going to succeed at one point and then on average, ten minutes later, that'll be the next success of some minor finding a new eligible block. Of course, there'll be fluctuations. Sometimes it'll be five minutes for the next block, sometimes it'll be 20 minutes for the next block.
00:12:40.410 - 00:13:04.070, Speaker A: But the 80 is set so that on average, you get one new block per ten minutes added to the chain and the protocol automatically adjusts this number 80 so that this is an invariant. So that blocks are sort of, on average being produced every ten minutes or so. So if blocks start getting created too quickly, sort of much faster than ten minutes, then 80 is going to get bumped up to a bigger number like 81.
00:13:04.070 - 00:13:17.178, Speaker A: On the other hand, if for whatever reason, miners sort of get bored mining and kind of go away. And so the rate of block creation slows down and gets much slower than ten minutes. Then it'll automatically adjust downward and the 80 will become 79.
00:13:17.178 - 00:13:44.398, Speaker A: So that's what the protocol is sort of aiming as an invariant one new block roughly every ten minutes. Probably you're asking what's so special about ten minutes and the point of the ten minutes is to make sure the block creation happens at a timescale which is slower than the time it takes for propagation of information across the peer to peer network. So ideally you want a block to be created that should be broadcast maybe it takes roughly a minute to reach everybody else in the peer to peer network.
00:13:44.398 - 00:14:02.378, Speaker A: But that's fine, everybody hears about it because the next block typically that's created will be ten minutes later. So that's the reason for ten minutes you have this inevitable latency in passing information around on a peer to peer network where the computers are generally distributed all over the globe. So that's going to take maybe a minute, maybe two minutes, something like that.
00:14:02.378 - 00:14:11.334, Speaker A: And you want blocks to be created on average quite a bit more slowly than that propagation delay. So that's where the ten minutes comes from. It's a little bit arbitrary.
00:14:11.334 - 00:14:22.350, Speaker A: Like if you decreased it to five minutes, probably things would be fine. If you decrease it to one or two minutes, the system would not function as well. So there is sort of an importance to that ten minute parameter.
00:14:22.350 - 00:14:42.786, Speaker A: Now, over time there's been a bit of an arms race where because of the economic incentives of mining, various people have been investing in more and more mining equipment, more and more computers, increasingly specialized computers. And as a result, this number, 80 has just been going up pretty steadily over time. And now it's actually so difficult to solve one of these crypto puzzles.
00:14:42.786 - 00:14:57.126, Speaker A: You really cannot do so using a general purpose computer. So using a CPU or GPU or even an FPGA, normally we think of computers as general purpose. You use the same computer to run a word processor or to run a spreadsheet.
00:14:57.126 - 00:15:15.818, Speaker A: You don't need specialized equipment for those different programs. But sometimes, if speed is of essence, you actually develop specialized hardware that can't do lots of stuff, but there'll be at least one thing it can do really, really well. So those are called Asics for application specific integrated Circuit.
00:15:15.818 - 00:15:34.966, Speaker A: And that's really how bitcoin mining is done these days and has been for several years. You really have no hope of solving one of these super hard puzzles unless you have specially built Asics where literally the only thing they can do is search for eligible blocks. So that's the bitcoin mining business.
00:15:34.966 - 00:15:43.480, Speaker A: It's a little crazy, kind of fun. Now let's move on to some of the things that can go wrong because of the way that the mining process works.
