00:00:00.410 - 00:00:00.766, Speaker A: Hello.
00:00:00.868 - 00:00:55.754, Speaker B: So the topics for today, this will be our final day on mechanism design, and we'll be talking more about mechanism design without money, and we'll be doing a case study in the first part of the lecture that will be on kidney exchange. And I would be remiss to not tell you about stable matching. So that'll be topic number two. So kidney exchange and sort of a great application of mechanism design without money just over the past ten years or so. So there's a lot of people with kidney failure out there. So there's a lot of people who could really use a kidney transplant. And an old idea which is not specific to kidneys but applies to all organ donation, is that you have deceased donors.
00:00:55.754 - 00:01:19.414, Speaker B: Okay? So I, and probably many of you have that orange dot on your driver's license which says, yes, you're going to go ahead and donate your organs. But there's something special about kidneys, which is we have two of them and generally we do just fine with only one. Okay? So if you're living, donating a heart isn't usually much of an option, but donating a kidney is.
00:01:19.612 - 00:01:20.360, Speaker A: Okay.
00:01:25.770 - 00:02:08.600, Speaker B: So there's a notion of living donors when it comes to kidney transplants. And so think about someone's spouse, someone's sibling, et cetera, who's actually happy to give up one of their kidneys for a loved one. All right, so there's a problem though. Sometimes this just works out. Sometimes just your spouse or your sibling will donate you a kidney and everyone lives happily ever after. The problem though, is that it is not the case that anybody can really successfully have a kidney transplanted from just anybody else. There are compatibility issues.
00:02:08.600 - 00:03:08.220, Speaker B: Blood type is a big one, tissue type also. These are the two first order issues that determine whether you're compatible or not compatible. So for example, if you're a patient with blood type O, then you really need a donor who's blood type O. If you're a donor with blood type AB, you really need a patient with blood type AB. And that's not the only issue, but that's one of the main issues. So that can be a bummer when the people who are willing to donate a kidney to you are incompatible. So here's an idea which started occurring to people, or at least it started getting executed toward the beginning of this century, which is suppose we had the following situation.
00:03:08.220 - 00:04:27.410, Speaker B: We have a patient, so someone who needs a kidney and they have a loved one who'd be willing to donate a kidney and they're incompatible. So let's say for concreteness that this patient has blood type A, whereas the donor has blood type B. So those are not compatible. But suppose there's another pair in the same situation, a patient potential donor incompatible, and the patient here has blood type B and the donor has blood type A. And these two pairs of people, generally speaking, will have never met each other, but if they knew they existed, despite the fact that they naturally showed up in these pairs, it seems like it might be a really productive idea to swap donors even though you have no idea who they are, even though you never met them. So the donor from the first pair could just donate compatibly to the second patient, and the donor from the second pair could donate compatibly to the first patient. So this is what's known as kidney exchange.
00:04:31.590 - 00:04:32.340, Speaker A: Okay.
00:04:37.530 - 00:05:40.170, Speaker B: So around the beginning of this century, kidney exchanges started happening, just isolated cases, kind of lucky ad hoc occurrences at a couple of hospitals. I think Johns Hopkins was one of the early pioneers, and they worked great. I mean, lives were being saved. And so then the obvious question is, well, if we can do this and we can save lives this way, we want to make sure that everybody's aware of all of the incompatible patient donor pairs out there. So you want, in effect, a quote unquote market for these pairs in the sense of awareness of who else you could be matched with. And so a clear question then, that people had to think about ten years ago, or even a little less, was how should you organize? Ideally, a nationwide kidney exchange, some kind of database where everybody's in this situation, person who needs a kidney, someone's willing to donate, they're incompatible. Pairs like that can go and register and you can look for matches across the nation.
00:05:40.170 - 00:06:39.100, Speaker B: So in some sense, you want to create a quote unquote thick market with lots of people in it so that you get as many matches of this form as possible, so that you save as many lives as possible. So what I'm going to discuss today is some of the theory that was done right when people were beginning to think about how to answer this question. I'll give you a little glimpse about sort of what's been concerning people over the past couple of years as well. But the national exchanges were indeed formed roughly the middle of last decade, and these are done now regularly. Okay, so there are algorithms which find matches that are run periodically. I had trouble finding the exact numbers, but I'm pretty sure it's thousands of transplants a year are done because of the algorithms and the mechanisms that have been designed for these national exchanges. Okay, so this is a big deal.
00:06:39.100 - 00:07:36.750, Speaker B: You now it's not an accident. I'm covering this case study on our week in mechanism design without money. So at least at present, any kind of compensation for organ donation is illegal in this country. It in fact in every country except I'm not sure exactly why this is actually, except in Iran. And while the waiting list for kidney transplants is roughly 100,000 people now in the US. There is not a waiting list for kidneys in Iran because you can in fact buy one legally. There there of course, are black markets other places as well, but it's completely legal market in Iran.
00:07:36.750 - 00:07:58.626, Speaker B: You can have an interesting debate maybe with your friends over dinner, either speculate or argue what's morally appropriate. Fast forwarding ten years from now. It's not obvious to me this will still be true. It's not obvious to me there will still not be a monetary market in this country. I think it's an interesting question. First question is like whether or not you believe there should be 1. Second question is just place bets.
00:07:58.626 - 00:08:54.310, Speaker B: Will there be one? Okay, so I'm going to touch on two early papers, meaning a little less than ten years ago by Al Roth, who's now here in the econ department and won the Nobel Prize in economics last year, in part for these contributions along with Sunmez and unbur. And so the first idea so in the first paper in 2004, these were ideas they were having before they really started talking seriously to doctors. So they were sort of just brainstorming at that point. And idea number one was to in fact, to have better matches between patients and donors. Apply the very algorithm I left you with on Monday, the top trading cycle.
00:08:57.950 - 00:08:58.810, Speaker A: Algorithm.
00:09:01.790 - 00:10:08.462, Speaker B: So I described that algorithm in the context of housing allocation problem, which was the same phrasing that Shapley and Scarf used back in 74 when they developed the solution. And the correspondence here is well before we had agents and their initial house. So in the context of kidney exchange, this is going to correspond to a patient and their donor, their incompatible donor that's like their initial household. So in addition to the initial endowments in the housing allocation problem on Monday, there are preferences in that problem. We are modeling preferences as a total order over all of the houses. So in this case, it would be a total ordering over the donors. And the sensible ordering over donors you would use as a patient would be dictated by your probability that that particular donated kidney would be a successful transplant in you, which is what your doctors help figure out.
00:10:08.462 - 00:10:55.758, Speaker B: So transplant success probabilities induce total orderings over the houses I e. The donors in the system. So the rest of the correspondence, total ordering of houses, probabilities of success. And what I hope you remember from Monday was this was this algorithm where everybody proposes to their first choice. And you look for cycles. And cycles are opportunity, are an opportunity to make everybody better off. So everybody sort of grabs what they want more.
00:10:55.758 - 00:11:33.542, Speaker B: And as you go around the cycle, everybody has something that's better off than what they had before. So what you're really hoping happens when you run the top trading cycle algorithm in this context is you're really hoping for just sort of simple things like this. Okay, so you're going to have a node that's a P. And in this context, a node represents the pair, both the patient and the donor that are incompatible with each other. And then you're going to have a second patient donor pair. And so the initial endowment here is just D one. The initial endowment here is D two, but each one so these are incompatible.
00:11:33.542 - 00:12:32.638, Speaker B: If I'm using the same data as on this slide, these are incompatible with themselves, but each is compatible with the other donor. So certainly this node has a preference for this initial endowment over its own because donor d two is more appropriate for p one than D one is and vice versa. So in the first iteration of the top trading cycle algorithm, whenever you say to everybody, point to your favorite house, I e. Point to your most compatible donor, you just get this nice little two cycle. And the top trading cycle algorithm then just says execute the swaps, which just basically says donor D two goes to P one and donor D one goes to P two. And one thing we did note, we said a few things about the top trading cycle algorithm, but one thing we said is that at least everybody winds up as well off as before. Okay? So the worst case scenario for you in participating in the system is that you wind up with the same incompatible donor that you started with.
00:12:32.638 - 00:13:36.942, Speaker B: And in the best cases, you wind up with someone that you're much more compatible with. All right? So that was sort of idea number one. Maybe we can just apply the top trading cycle algorithm out of the box. So there are some issues with doing that. And so let me tell you one that's sort of easily handled in the same model, and then I'll tell you about two others which really motivated changing the model for the second contribution. So in addition to just proposing that tools for mechanism design should be applied to the need for a kidney exchange, and in addition to proposing that maybe the top trading cycle algorithm could be useful, they also worked out the following extension. Which was they said well, actually, in the real systems, in the real exchanges, you don't just have these incompatible patient donor pairs.
00:13:36.942 - 00:14:08.090, Speaker B: You also have patients that are not lucky enough to have a living donor, okay? So that would correspond to an agent who does not initially have a house in the housing allocation problem. In fact, there's also things that correspond to a house with no owner. In this context. You see what that is? So a deceased donor does not come along with some patient that they're trying to save that they're incompatible with, okay? So that's a house with no initial owner that could be allocated to anybody.
00:14:08.240 - 00:14:08.940, Speaker A: Okay?
00:14:10.450 - 00:15:08.862, Speaker B: So the extension was to in addition to just the basic patient donor, incompatible pairs accommodate patients without donors and then also deceased donors, again corresponding to agents without initial houses and houses with no initial owner. And they showed that you could extend the top trading cycle algorithm to this more general setting. So in addition to swapping on chains, now you're swapping sometimes on paths, because basically a house won't point to anything by itself and so on, and it remains dominant strategy incentive compatible if you implement it properly. And this is a little tricky, actually. So this is not if I had 45 minutes of lecture time to devote to it, I could go through it, all of you would understand it. But it's not just a trivial extension of the basic algorithm. You do have to do some work.
00:15:08.996 - 00:15:09.680, Speaker A: Okay.
00:15:13.490 - 00:15:55.306, Speaker B: One thing that was amusing was actually the algorithm that they used for this extension had already been worked out because it had been motivated by a totally different problem roughly six years earlier, which was that of assigning students to dorms. So they wanted to use one of these top trading cycle like algorithms, but they had this issue where there were some students who say had been juniors and now are seniors, so they were incumbents, so you wanted to give them the option of keeping their current room. There were new students, freshmen, just showing up. So they didn't have an initial room, no initial endowment. And then there were the students who graduated who left some empty rooms. So you had this sort of ecosystem of incumbents people with an endowment, rooms that could go to anybody, and then people with no room. So that's actually the context in which this algorithm was developed.
00:15:55.306 - 00:16:44.960, Speaker B: But then they realized it also made sense in this kidney exchange context. Okay. Questions? At this point, it okay, so let's talk about a couple of other issues with this first idea. Okay, so remember the top trading cycle algorithm, people point to their favorite remaining good, and then you get at least one cycle, and you swap along these cycles. So in that example, it was a two cycle. How big could these cycles be in general? In the top trading cycle algorithm? Yeah, you have no idea, right? I mean, you might just wind up with a Hamiltonian cycle in the very first iteration. It's possible.
00:16:44.960 - 00:17:35.306, Speaker B: And in general, you might get long cycles. Okay, so that's just an observation we could have made yesterday. It so fine, but now so is this why is this an issue? Okay, well, to explain why this is an issue, let me actually back up. Suppose it actually was just a pairwise exchange. Suppose we're back in the most basic case, p. Suppose we do the swap. So how many surgeries, how many separate surgeries does that entail this pairwise exchange? Four, actually.
00:17:35.306 - 00:18:44.782, Speaker B: Okay, there are two people you got to take a kidney out of, and there's two people you got to put a kidney in. So that's four separate surgeries. Now it's clear that a given pair, it's clear that pairs of these have to be done simultaneously. So when you take the kidney out of this person you're going to put it basically immediately into this other person. So those happen at the same time at the same hospital, for sure. Okay, what about the two different pairs? So what about P one and D two and then P two and D one? Can those happen sequentially asynchronously or do you think that might be asking for trouble? Is there something that could go wrong if you first did P One and D Two, and then like tomorrow it was scheduled to do P Two and D one? Say what? Yeah, I mean, they might get on a plane to Chile, right? That's what you're worried about, right? So you might be worried about reneging, and it would be kind of a double whammy if that happened. So the first thing which you might rightfully complain about is that in some sense, p One got a free kidney and D Two didn't have to donate.
00:18:44.926 - 00:18:45.620, Speaker A: Okay.
00:18:45.990 - 00:19:36.370, Speaker B: Which seems unfair, but actually the much more serious problem is that P Two did not get a kidney, is as sick as before and lost its only leverage to be in this exchange in the first place. So their sibling or spouse actually no longer has a second kidney to donate. Okay? And that's really kind of a deal breaker. So as far as I know, it's never been tried. When you have these exchanges, these cycles, to do them non simultaneously, as far as I know, they have only been done simultaneously. So no one's even had the opportunity to kind of pull that kind of a shenanigan. Okay, so all surgeries on a cycle have to be done simultaneously.
00:19:36.370 - 00:20:29.618, Speaker B: One thing that's sort of interesting is actually there have been chains being done recently, just the last couple of years. Also, one reason that chains have been happening is because of altruistic living donors, as they're called. So sometimes you get someone who just, in effect, walks into a hospital and says, I want to donate one of my kidneys and save a life, and they don't have anyone kind of in mind. And so when you have this initial living donor, then in fact, they have done chains of even up to, I think, 30 people. And that is not simultaneous. That is done sequentially over a month or two. And if you think about it, if somebody renegs along this chain, the first issue we talked about before, someone getting a kidney for free is still there.
00:20:29.618 - 00:21:00.798, Speaker B: But the second issue, which was the really serious one, which is someone not getting a kidney and losing their donor. That can't happen if you start with an altruistic donor. So people have been experimenting with these sequential ones, but for the cycles, they do it simultaneously. Okay? Remember, if there's K people in the cycle, there's going to be two K surgeries, which have to all be synchronized at exactly the same time. And you need a different operating room, a different surgery team for each of those point being is you really, really want to actually have to keep these cycles short.
00:21:00.964 - 00:21:01.680, Speaker A: Okay.
00:21:09.590 - 00:21:17.790, Speaker B: So that's issue number one. So again this model started coming about as the economists were talking to doctors.
00:21:17.870 - 00:21:18.594, Speaker A: Yeah.
00:21:18.792 - 00:21:21.558, Speaker C: How many different possible types are there?
00:21:21.644 - 00:21:22.086, Speaker B: What do you mean?
00:21:22.108 - 00:21:34.620, Speaker C: Like if you only had a few, say there are five different types of kidneys, seems like that could affect your cycle length. You might as well make this guy.
00:21:36.670 - 00:21:57.060, Speaker B: Yes. So there's diminishing returns for having longer and longer cycles because of the reason that you say so still in principle you could have arbitrarily long cycles. But I'll get to this in a second. I mean about exactly where's the sweet spot, how long should the cycle be? And because there aren't that many types, there's no point in having super long cycles yeah.
00:21:57.750 - 00:22:05.330, Speaker C: When you're deciding proximity and feasibility of a simultaneous.
00:22:07.430 - 00:22:21.974, Speaker B: Surgery. Absolutely. Yeah, right. This ordering is going to just come from the doctor and that can be for everything. I mean, people definitely travel for these though. That's a pretty second order effect. You've been on this list for a year and you're on dialysis.
00:22:21.974 - 00:23:15.500, Speaker B: I mean it's kind of a second order thing having to travel especially this is just the US. But yeah, with your doctor you would formulate kind of you could use in some sense whatever information you want. That said, I'm actually now going to go in the opposite direction. And empirically, again, you started talking to doctors and how things really work and you realize that actually this total ordering model is kind of not the right model of preferences and kidney exchange. I mean really, if you're one of these patients you just want to know is the transplant kind of probably going to work or is it probably not going to work? It's much better modeled as a binary preference as opposed to a total ordering. So empirically patients exhibited and their doctors exhibited basically no relative ordering amongst equally compatible kidneys. So it's really to first order a 10 problem.
00:23:15.500 - 00:24:58.970, Speaker B: So preferences closer to binary than total order. Okay. So in light of this, so both to keep the cycle short and to really leverage this accurate simple preference model, the plan is to use matching tank graph matches. So let me explain any questions in the meantime. So matching is I'm hoping you know or picked up from that exercise set or what have you, a matching and a graph is just a collection of edges where no pair of edges shares an endpoint. So they're all mutually non adjacent edges. So how are we going to use matchings here? So what's the graph? So the nodes are just these incompatible patient donor pairs.
00:24:58.970 - 00:26:01.950, Speaker B: Okay. So like in that picture, a node has both a patient and a donor so that's the node set incompatible pairs and an edge just means between a given pair of pairs, if you will, it just means that we have the opportunity we have on that board. Okay? It means that the first donor is compatible with the sufficiently compatible with the second patient, and vice versa for the second donor in the first patient. Okay, so you can do this kidney exchange with a good probability of successful it node pairs. Okay, so that's a graph. Undirected graph. Told you the vertices, I've told you the edges.
00:26:01.950 - 00:26:10.170, Speaker B: So we're now going to define the optimal solutions.
00:26:10.250 - 00:26:10.494, Speaker A: Okay?
00:26:10.532 - 00:26:13.900, Speaker B: So we're going to say what is the feasible solutions and which of those we want?
