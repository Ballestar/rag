00:00:00.250 - 00:00:23.006, Speaker A: All right, so a brief recap, right? So we started talking about first price auctions which are natural enough but have the drawback that it's kind of difficult to figure out how to bid in a first price auction. It takes a lot of sort of cognitive effort. And that naturally led us to the new transaction fee mechanism proposed in EIP 1559 which Ethereum switched to in early August of 2021.
00:00:23.006 - 00:00:50.230, Speaker A: We learned about the burned base fee in that transaction fee mechanism, the new one. And we learned about why the base fee revenues are burned because otherwise it can be evaded by users and miners through off chain collusion. We learned about how that base fee gets adjusted over time through a local search procedure where blocks that are bigger than a target lead to an increase in the base fee while blocks that are smaller than a target lead to a decrease in the base fee.
00:00:50.230 - 00:01:08.462, Speaker A: And we saw how in order to accomplish that we needed to introduce variable size blocks. So there's a target block size of capital C and that's supposed to be the average block size over time. But we do allow sort of doublings double full blocks if necessary if there's a sudden spike in demand.
00:01:08.462 - 00:01:14.466, Speaker A: So the hard per block cap is two C. The target, the sort of.
00:01:14.488 - 00:01:18.386, Speaker B: Target average block size is C. So.
00:01:18.408 - 00:01:33.686, Speaker A: That was all very cool. I think it's sort of obviously a really neat mechanism but we still need to close the loop, right? I mean we sort of set out on that path with the expectation that somehow it would be easier to bid. It would be more like the kind of posted prices you see when shopping on Amazon.
00:01:33.686 - 00:01:58.206, Speaker A: It would be easier to bid than what it has been in first price auctions. But to what extent is that actually true? So what I want to explain on this slide is two different regimes and in one of those regimes which is also going to be the common regime, actually we're going to get everything that we want. It will be the case that the transaction fee mechanism proposed in EIP 1559 is in fact kind of very simple to figure out how to bid.
00:01:58.206 - 00:02:19.498, Speaker A: It's really basically as simple as shopping on Amazon. There will be a second regime which is fortunately the less frequent one in which really this transaction fee mechanism sort of reverts back to a first price auction with all of the kind of pros and cons you have of a first price auction. And so what it is that determines which of these two regimes you're currently in.
00:02:19.498 - 00:02:52.562, Speaker A: What matters is whether or not the current base fee, little R is what I'm going to call excessively low. So, by definition, a base fee will be called excessively low if the total size of the eligible transactions at that base fee. Meaning if the total size of all the transactions that have bid are or more the ones that could potentially be included in the block, if the total size of all those eligible transactions exceeds even the size of a double full block exceeds even two times the target size.
00:02:52.562 - 00:03:00.514, Speaker A: Capital C. That's when we call the base fee excessively low. Now, don't forget the local search procedure.
00:03:00.514 - 00:03:17.866, Speaker A: That's part of the transaction fee mechanism. I mean, that's actually adjusting the base fee up and down to try to find the market clearing price with respect to a normal size block with respect to a capacity of capital C. So if ever it's the case that the total size of all the pending eligible transactions exceeds one times capital C.
00:03:17.866 - 00:03:32.574, Speaker A: That's already a base fee that is too low and that we want to increase here. We're saying like, not only is the total size of the eligible transactions bigger than capital C, it's even bigger than capital two C. So that's the sense in which this base fee is way lower than the market clearing price.
00:03:32.574 - 00:03:47.070, Speaker A: That's the sense in which it's excessively low. So to appreciate why there's sort of almost a phase transition around whether the base fee is excessively low or not, think about how things look from the perspective of a minor. So you're a minor.
00:03:47.070 - 00:04:13.310, Speaker A: You're trying to put together a block and you're trying to figure out which transactions to include. Well, if the base fee is not excessively low, this is not a hard problem because you have room for everybody, right? If the base fee is not excessively low, by definition that means the total size of all of the eligible transactions is at most two times capital C. And we're totally allowed to produce blocks of size up to two times capital C.
00:04:13.310 - 00:04:28.622, Speaker A: So we don't have to actually choose winners and losers amongst the eligible transactions. We can just include all of them. On the other hand, if R is in fact excessively low, now is the minor, you cannot accommodate all of the eligible transactions.
00:04:28.622 - 00:04:32.606, Speaker A: You need to separate them into winners and losers just as one would normally.
00:04:32.638 - 00:04:34.130, Speaker B: Do in a first price auction.
00:04:35.190 - 00:04:49.862, Speaker A: Now, this same dichotomy that determines whether or not sort of the transaction selection problem is trivial for the minor because it can just pick everybody or nontrivial for the miner where it has to make decisions about who's a winner and who's a loser. That dichotomy translates directly into how easy.
00:04:49.916 - 00:04:53.434, Speaker B: It is for users to bid, right?
00:04:53.472 - 00:05:15.850, Speaker A: Because if the base fee is not excessively low and then the eligible transactions are not competing with each other, there's no reason to bid more than the minimum. Little R the miner can go ahead and accommodate everybody willing to pay. Little R or if you don't want to be a cheap skate and bid literally the minimum possible amount.
00:05:15.850 - 00:05:41.810, Speaker A: Little R you could imagine adding a sort of small tip to the miner. So bidding R plus Delta instead of R, don't forget that in this transaction fee mechanism while the base fee revenues are burned, so that R is burned, if a bid is in excess of the base fee, then all of that excess actually gets transferred to the block's minor. So by adding a small tip, you can incentivize a miner to include your transaction rather than just sort of leaving the block empty.
00:05:41.810 - 00:06:18.318, Speaker A: And indeed, since this transaction fee mechanism was deployed on ethereum, this is what we've been seeing in practice. So when you have blocks where there is room for everybody, where there's no competition between transactions, you do indeed see nominal tips, right? So a typical amount would be something like four GWe, whereas a typical gas price, a typical sort of base fee might be more like 100 GWe. So in this regime, when the base fee is not excessively low, it is basically as easy as shopping on Amazon, right? Amazon, you go to a product page, there's a posted price like $20 for a book.
00:06:18.318 - 00:06:31.554, Speaker A: You can take it or leave it. And in this regime, again, it's sort of a take it or leave it offer from the blockchain about what you need to pay for transaction inclusion. Either you're willing to pay R or maybe R plus some little delta or you're not.
00:06:31.554 - 00:06:46.034, Speaker A: It's a take it or leave it offer at that posted price. There is, of course, still this other regime where the base fee is excessively low and then things are not quite so rosy. There isn't then room for all of the eligible transactions.
00:06:46.034 - 00:07:08.862, Speaker A: So miners have to pick winners and losers and it means creators of transactions, like in a first price auction, have to compete with each other through their bids. So again, remember, the excess between the bid and the base fee is what gets transferred to the miner. So if a miner has to make decisions, you would expect it to prioritize the transactions with the highest bid because that would maximize its share of the transaction fee, the bid minus the base.
00:07:08.916 - 00:07:12.346, Speaker B: Fee, little R. So in this regime.
00:07:12.378 - 00:07:31.750, Speaker A: The transaction fee mechanism does not act like a posted price mechanism. Again, as the creator of a transaction, you need to sort of reason about how big you think your bid needs to be to be able to beat out all of the competition. So basically, when the base fee is excessively low, this transaction fee mechanism in EPP 1559, it basically reverts back to a first price auction.
00:07:31.750 - 00:08:00.046, Speaker A: Now, to be clear, this situation is a major improvement over what we had with first price auctions, right? In first price auctions, there are literally no interesting conditions under which it's easy to figure out what you should bid. Whereas here with this transaction fee mechanism, okay, it's not 100% of the time it's going to be easy to figure out how to bid. But at least in this one regime, as long as your local search algorithm is doing a halfway decent job of sort of adjusting the base fee to be somewhat close to the market clearing price.
00:08:00.046 - 00:08:32.214, Speaker A: Under those conditions, it is in fact easy to figure out how to bid. Now, the obvious question you probably have is, well, should I expect to typically be in the good regime or the bad regime? Should I expect the base fee to typically be excessively low or not? So let me start with the first and maybe more obvious reason that you would expect to at least once in a while see blocks that have an excessively low base fee. And that's because once in a while you're going to see a very sudden, sharp increase in demand for the blockchain.
00:08:32.214 - 00:08:59.246, Speaker A: So for example, whenever there's sort of a major NFT drop on ethereum, you do see this sort of sharp increase in the market clearing price. So it might go something from like 100 gay to 500 GWe in a very short period of time. And while the market clearing price might suddenly quintuple, there's a limit on how rapidly the base fee is going to go up because that's computed inside the protocol and in the current implementation it goes up by at most twelve and a half percent per block.
00:08:59.246 - 00:09:27.630, Speaker A: That's how fast it goes up if you're seeing double full blocks. And so what that means there will be this transitory period which will be on the order of sort of some number of minutes, maybe five minutes, maybe like ten at the most, where you're still waiting for the base fee to sort of catch up to the new higher market clearing price. And during that transitory period where the base fee hasn't increased sharply enough yet to catch up to the market clearing price, in that period, you will be seeing excessively low base fees.
00:09:27.630 - 00:09:57.450, Speaker A: So before this transaction fee mechanism was deployed, this is what I thought would be the sort of primary culprit for excessively low base fees in a post EIP 1559 world. These sort of sudden increases in demand. And those, of course, are going to happen, no doubt about it, but they're not happening all the time.
00:09:57.450 - 00:10:21.218, Speaker A: So in my mind, just speculating about what would happen after the transaction fee was deployed, I was thinking, you know, I'll bet you're going to be in the good regime like 95% of the time, where you have room to accommodate everybody, and only 5% of the time will the base fee be excessively low. And you'll see double full blocks is. Now of course, since the transaction fee mechanism has actually been deployed in early August of 2021, we can just watch.
00:10:21.218 - 00:10:31.400, Speaker A: We can just see what the block sizes are. And there's various websites where you can sort of track that kind of data. One that I particularly like is called Watchtheburn.com.
00:10:31.400 - 00:10:44.026, Speaker A: And if you go to watchtheburn.com, at least at the time of this recording, it certainly is the case you're in the good regime much more than the bad regime. So most of the blocks you see, the majority of the blocks that you see are not double full.
00:10:44.026 - 00:10:57.934, Speaker A: And so apparently the base fee at that time is not excessively low, but it definitely varies. But you definitely see periods where more than 10% of the blocks are in fact double full. And that sort of surprised me.
00:10:57.934 - 00:11:06.114, Speaker A: But then I realized there's actually sort of a second reason, at least in the current sort of proof of work implementation of Ethereum, that you're going to.
00:11:06.152 - 00:11:10.466, Speaker B: See some additional double full blocks, right?
00:11:10.488 - 00:11:41.762, Speaker A: Because I've sort of been talking about Ethereum as if blocks just come out like clockwork once every 13 seconds or so. But remember, that's only on average and it is a random process that's determining the block production, right? So to produce a block, some miner has to come up with a solution to a hard crypto puzzle. And so while the difficulty is tuned so that on average, a crypto puzzle solution will be found once every 13 seconds, there will be times where the miners just get unlucky and it takes them twice as long to find a crypto puzzle solution.
00:11:41.762 - 00:12:12.826, Speaker A: And then you'll see 26 seconds between consecutive blocks, multiple times a day, you'll see 40 seconds between two consecutive blocks. So let's think through the consequences of that. So that means that even if you had exactly the right market clearing price so that if you had a normal duration between blocks, 13 seconds, if you set the base fee so that you'd have exactly capital C units, of eligible transactions.
00:12:12.826 - 00:12:37.362, Speaker A: But then if it takes three times as long to create a block, and the sort of rate of arrival of eligible transactions stays steady, all of a sudden you're going to have three times as many eligible transactions as you thought you were going to. Not because there's anything wrong with your base fee, just because of the random variability in the underlying block production process. So these, I now believe, are the two main culprits for when you're in sort of the bad regime.
00:12:37.362 - 00:12:53.998, Speaker A: So when it is that a block producer doesn't actually have room to accommodate all of the eligible transactions, sometimes it's because your base fee actually is too low and it just needs to catch up to the market clearing price. Sometimes you just got unlucky and just like it took a ton of time to produce the next block and a ton of transactions came in in the meantime and you don't have room to.
00:12:54.004 - 00:12:55.360, Speaker B: Accommodate all of them.
00:12:56.370 - 00:13:26.182, Speaker A: Now, interestingly, if, as planned, ethereum switches over to their proof of stake design in 2022, then actually this second culprit will mostly go away because in their proof of stake design, they really will be producing blocks more or less like clockwork every 12 seconds or so. So you won't have this sort of big random variability between consecutive blocks. You'll still have the first culprit, you'll still have these sort of sudden shifts in demand and the base fee will take some time to catch up.
00:13:26.182 - 00:14:02.302, Speaker A: But after a proof of stake switch, I would at that point expect you to be in the good regime with a base fee that is not excessively low, I would think at least 95% of the time. So, Summarizing, in what sense is the transaction fee mechanism in EIP 1559 better than first price auctions? From the perspective of the user experience, the ease of estimating appropriate fees? Well, what we see is that in the good regime, which is the more frequent regime actually, you really do have simplified bidding. Really you should just bid the base fee maybe plus a small tip to the miner.
00:14:02.302 - 00:14:12.594, Speaker A: And the reason you can get away with that is with the appropriately set base fee there's room for everybody. You don't have to compete with other transactions. There is this bad regime, which is the more infrequent regime.
00:14:12.594 - 00:14:26.338, Speaker A: It will happen sometimes, but hopefully not very often, where it does sort of revert to a first price auction. But hey, that's no worse than we had it before. Okay? So now let's move on to the final video of this lecture of lecture eleven.
00:14:26.338 - 00:14:33.370, Speaker A: I want to fulfill the promise I made you earlier here and talk at some length about the ramifications of burning fees.
00:14:33.450 - 00:14:35.050, Speaker B: I'll see you there. Bye.
