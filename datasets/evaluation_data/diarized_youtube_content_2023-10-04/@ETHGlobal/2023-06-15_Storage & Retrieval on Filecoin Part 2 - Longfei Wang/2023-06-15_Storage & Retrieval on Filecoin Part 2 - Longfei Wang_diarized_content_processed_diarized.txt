00:00:07.450 - 00:00:21.120, Speaker A: Hello everyone and welcome to the Hack FS Filecoin Storage and retrieval on Filecoin part two session. Joining us today is Longfei Wong who will be taking us through this session. And with that I'll pass it over to Longfei to get the session started.
00:00:24.620 - 00:00:37.570, Speaker B: Thank you. So you'll be able to see my slides, right? So if it works fine. And I'm going to start today's session.
00:00:37.570 - 00:01:02.810, Speaker B: Hey everyone and good morning. Good afternoon, good evening whenever you add and welcome to listen to this talk about storage part two. I hope you guys have spent some time and listened to what Matt has talked about last time and about making storage deal on filecoin through smart contract, either through client contract or through the aggregation.
00:01:02.810 - 00:01:26.098, Speaker B: So this topic will be part two and after what Matt's talk and we'll talk a little bit more about what afterwards. If you make a storage deal on Filecoin, what it can do to replicate, to renew or maybe to repair on the Filecoin virtual machine through the smart contract. So let's maybe introduce myself a little bit.
00:01:26.098 - 00:02:03.790, Speaker B: And my name is Lonfei and I work with the Filecoin developer advocate and now because FVM is super important on that so I'm going to mainly helping on FVM team as well. So if you guys work with hackathons and you guys stay in the community either through Slack or Discord, you might see my name popping around everywhere. I'm trying to help developers in the community and hopefully I'm being helpful and be able to bridge you guys with the team, product team or our engineer team to be able to fix your problem and to providing a better and more stable infrastructure for building things on filecoin.
00:02:03.790 - 00:02:38.010, Speaker B: Cool for guys have been listening and following other Filecoin workshop and you might have seen this slides thousands of times. But I think that's a great slide to be able to tell what the Filecoin plan is and why we're doing things at a certain stage of the development phase. If you are not and the first time jump into this workshop and I will give you a brief talk about what Filecoin are doing and why we bring FDM on board at this period of time.
00:02:38.010 - 00:02:58.942, Speaker B: So obviously filecoin is building a decentralized network, decentralized storage to provide the storage for all the web two or web three words decentralized storage. Obviously the storage is most valuable things for us. Starting from 2002 or 220 we launched the main net.
00:02:58.942 - 00:04:01.514, Speaker B: We are putting a lot of effort trying to providing the decentralized capacity into the network, trying to onboard a storage provider, trying to onboard storage provider to provide more stable storage to the global. That's the first that we've been doing and we've been doing a great job since 2020 and then the network has growed a lot. If you look at our Blockchain Explorer or any static website, you will find out that the storage capacity, regardless of raw storage capacity, or that just the storage capacities through Filecoin Plus have grown rapidly until like twelve or 13 gigabit right now and after that, obviously we want to onboard data on filecoin we want to onboard the data like valuable data set and humanity data set on filecoin either through Web two applications collaborations or providing the storage for all sort of the Web three applications platform like Ethereum, Solana and near or any blockchain to onboard the data on filecoin.
00:04:01.514 - 00:04:31.850, Speaker B: And that's growing very great as well. And the third step is what we're doing right now. We are trying to bring the service on filecoin and harvest the real value stored on Filecoin, which is data, and then providing the computation through this data, either through the data or through the status of the data stage of the status on Filecoin and to be able to build another web scale application is on filecoin.
00:04:31.850 - 00:05:02.390, Speaker B: And that's where we bring Filecoin virtual machine into the picture to be able to provide the on chain programmability through the data, through the state of a data on filecoin as well as other computations like rakalao, things like that. And this is a brief idea of what we are doing and why Filecoin virtual machine is important and how it will bring the programmer into the Filecoin network. I think.
00:05:02.390 - 00:05:25.134, Speaker B: Now, we've been talking about Filecoin and we've been talking about how Filecoin is providing the data for web two, web three. Now, because we are at a hacker fest and we're trying to get developers interested to be on Filecoin. And so the most important part is how are we going to build on Filecoin and what kind of a service and what kind of tools that we can use.
00:05:25.134 - 00:05:56.026, Speaker B: I think for developers, we want to be clear that we want to be clear to developers that based on what you're building, you need to find the right builders, paths to go, to follow, to use the right tools to build. And we don't want the developers to bump into the road that they're just completely using the wrong tool and debuting things that would not expect them to do so. This diagram prepared by Sarah, one of our team members on Femt, is great.
00:05:56.026 - 00:06:09.258, Speaker B: It's very clear. And then guided develop through the process of picking the right tool and thinking from the perspective what the product needs. So we can look at this diagram from two sides.
00:06:09.258 - 00:06:41.318, Speaker B: The left side. The green part is if you want to build something more programmable on filecoin which means if you want to using the programmable storage on filecoin and then the right side is if you don't and for the applications that you're building. You just want to store your data in a decentralized manner that is, you just want to put your data in filecoin or IPFS network and you don't need to handle or like making storage deal and monitor the storage data or doing the renew or replication, that kind of job.
00:06:41.318 - 00:06:56.778, Speaker B: And you will go this way. For example, if you're building an NFT project, if you're building a GameFly project like AI or Social, you just want to store your data in a decentralized manner out of the control of any central party. And you go this way.
00:06:56.778 - 00:07:12.740, Speaker B: All you need to do is use this storage service. Web three storage NFD storage lighthouse or s three. Now they change to Falconator Tools and then all you need to do is just store data and then those storage service will take care of the storage deal making process.
00:07:12.740 - 00:07:34.354, Speaker B: So actually all those storage service are the builders for the left side of this diagram. This diagram. So they are building something on filecoin and those storage service will build on filecoin storage.
00:07:34.354 - 00:08:07.714, Speaker B: We need to make storage deal on filecoin network and monitor the storage status and be able to renew and repair. And also if the data are small, they also need to do aggregation. If you are building some data service like Web Three Storage or Asteroid, and you mainly going to link on the left side of the picture, or if you're building something like we've been talking about data dow perpetual storage and Storage automation, then you also need to go with a programmable storage side.
00:08:07.714 - 00:08:28.038, Speaker B: And if you're storing some data on smaller size or less than four gigabit, which is what we distinguish of smaller size, the smaller data, large data on filecoin and you probably need to go through the aggregation. Or if you're storing data larger than four gigabit, you can go on the deal. Clients, all this have been covered by Matt from the previous session.
00:08:28.038 - 00:09:10.626, Speaker B: And then the thing that I'm going to cover mainly today is if I made a deal on filecoin, regardless through aggregation or without aggregation, there's a deal lended on filecoin. We just need to keep monitor and then be able to replicate as many copy as we want and be able to renew or maybe essentially we'll be able to repair if there's something wrong with the storage deal on filecoin. Today, I think we just want to be clear if you are in this workshop and if you are interested into building perpetual Storage or renewal repair and you're going to mainly lend it on here, but if you're building, that's the part of a developer.
00:09:10.626 - 00:09:40.094, Speaker B: So we want to track developers who are interested in this site and pay more attention to this workshop if you're building NFT or DeFi and the storage service might be the best options for you. Okay, so let's get into it because everything I'm going to talk about today is for the storage deals. I want to go back one step and to refresh everybody's mind on how filecoin storage works.
00:09:40.094 - 00:10:16.518, Speaker B: I think Matt has also covered that in previous talk. But I'm going to bring it again because that will be important for you to understand how we'll make some of those process on filecoin on the Filecoin virtual machine through smart contract and why we are doing certain work like why we're doing replication while we're doing renew and while we're doing things through aggregation. All right, let's first go through this storage deal making process very quickly and we'll see what we can put on filecoin virtual machine and what we can do is renew.
00:10:16.518 - 00:10:38.930, Speaker B: So let's starting with the client spot. If you as the client of Filecoin and you want to store data on Filecoin. So the first step what you do is you can find your wallet and you need to have certain field token in your wallet, so you'll be able to pay the storage service fee and maybe potentially pay a collateral from your storage.
00:10:38.930 - 00:10:55.218, Speaker B: Or you can use data cap to store your verified data on Filecoin. And that's the essential part of using Filecoin. And then once you have that you want to store data, the first step you need to do is do data preparation.
00:10:55.218 - 00:11:16.958, Speaker B: So you need to prepare your data from regular file into the call file which is the data format used on filecoin and IPFS based on IPLD standard and you'll be able to retrieve them by the CID. So those call file can be either saved on the file server or IPFS. Eventually the storage provider will retrieve this data and store for you.
00:11:16.958 - 00:11:53.046, Speaker B: Once you have that ready, the second step is you need to make a storage deal proposal to the storage providers on filecoin based on what the storage provider requests, based on the geographic of the storage provider. So if the storage provider sees that a proposal come in and that's okay for them, they will accept this deal and then eventually request the data you want to store from the file server and IPFS. And once they get it done, they will publish these storage deals on chain on the Falcon network and after going forward they'll just keep proofing the storage they have stored through the proof of replication or proof of FaceTime.
00:11:53.046 - 00:12:31.430, Speaker B: So from that there was something stay on chain which is deal, storage deal and then storage deal will have all this information recorded on chain. I won't bring this up because that's the most important value, best importance paramount on that deal is starting epoch and end epoch which indicates that how long this storage deal will leave on filecoin network as well as if this storage deal is active on filecoin or not. That's very important for renewal storage or repair storage or making sure that we store the enough replications for these clients as they wish.
00:12:31.430 - 00:12:57.870, Speaker B: And as you know, this whole process happens on chain and off chain obviously. And from this picture you can see data preparation, storage deal proposal, data transfer, all this happened off chain and then deal publish proof of the deal and then storage deal on chain. So now with Fem coming in, we are trying to move some of the component on chain through the programmability on the smart contract.
00:12:57.870 - 00:13:30.534, Speaker B: So now if you imagine that you can start using a few token to fund your storage and maybe you can have your own token to fund the storage trying to incentive data, trying to incentive clients to use trying to incentive storage provider maybe like geographically to send it. And then the second part we can make it on chain is making storage deal like Matt's presentation last time for the first part of the process that we can make deal through the client contract. Which means you propose.
00:13:30.534 - 00:13:58.530, Speaker B: Deal in the contract and contract will immediate events on chain and the storage provider Boost will be able to pick it up and publish deal. All the orange part that I put it here will be able to make on chain through smart contract. And another part, most important part I'm going to talk today is we can also make the deal renew deal repair and deal replication on chain as well and on chain will be able to monitor all this process and make it eventually on chain.
00:13:58.530 - 00:14:18.934, Speaker B: Before we go into all this detail of the renew and replication, I want to bring another concept up is Aggregation. The deal aggregation. And Matt also talked about last time, so I want to emphasize a little bit more because that's also something that is very important in the Filecoin ecosystem.
00:14:18.934 - 00:14:44.798, Speaker B: And I think it's a super interesting idea for developers to build on top of it as well. And you can see there's a QR code down here if you're interested in building aggregator, you can just go scan and look at the specs that our product team prepared for you and you read through and see if it makes sense if it's something interested for you to build and then go forward. If you have any question, just talk to us, talk to product team on filecoin.
00:14:44.798 - 00:15:36.910, Speaker B: But essentially what is a good grade chain? Why is the need you probably heard I talk about data size over and over again because there are some data size that we call sector size which is on filecoin is how big the data USC you store and then on a file coin the sector size is 32 gigabit or 60 gigabit. Imagine that if you store like NFD data which is like a few gigabit or maybe 1 MB, how much data you need to store to pack to 32 gigabit that's a lot of data you need to pack into there and it's not economic friendly for the storage provider to pick up a small data and then store. Imagine like 32 gigabyte and you put thousands of files into one deal and it will generate tons of messages, generate tons of proof for storage provider dude.
00:15:36.910 - 00:15:56.730, Speaker B: So it's like expensive execution, also very expensive on gas fee. And imagine all those deals will come a different turn like how long they want to store, how much they wanted to pay and what storage bird they need. It's very difficult to handle and that's why we bring aggregation into the picture.
00:15:56.730 - 00:16:44.614, Speaker B: So what aggregation do is the aggregator will listen other files and pack them into one deal and one deal or maybe a call file to also at the same time generate what we call parsi. It's an inclusion proof that you can improve that your file is included in that call into that sector and then be able to verify that as well. Imagine that if you're putting all your files into a plastic bag you would not be able to verify and parsi is the standard that we bring in to be able to help to verify the aggregation and then the process of aggregating the files and generating the proof all could happen on chain and off chain as well.
00:16:44.614 - 00:16:56.714, Speaker B: On chain means through smart contract. Off chain means what web three storage or falcon data tools are doing. And they are building by some of the collaborators in our system as well.
00:16:56.714 - 00:17:29.320, Speaker B: Like falcon data tools, lighthouse and sephora, they are building this if you're interested building an on chain aggregator, off chain aggregator, go scan this code and you'll be able to just learn. If you want to see some example, maybe you can see how Falcon Data Tools and Lighthouse are building their solution. So keep in mind aggregation aggregator is very important to handle small deals and that's what we're going to take as example for our deal aggregation, renew and deal application.
00:17:29.320 - 00:17:48.090, Speaker B: We are using the aggregator in this example but of course if you are storing some data with larger size you can directly use a client contract to do it. So let's look at this picture. So now we're talking about renew what do we call ros.
00:17:48.090 - 00:18:07.570, Speaker B: You could do replication as a service, renew as a service or essentially repair as a service. So what we'll do and we can look at briefly on this side is if I'm a client and I want to store my data on filecoin. So if this data are small, first I need to store that with aggregator.
00:18:07.570 - 00:18:40.602, Speaker B: So Aggregator will have a smart contract which will be able to record all the data coming and there's going to be aggregator function will be aggregate all the files together and then generate the proof essentially send the proof back to the clients or recorded the proof in the smart contract. And that's part of once you successfully make a storage deal. And a storage deal will leave on filecoin network regardless it's to aggregator or not aggregator.
00:18:40.602 - 00:18:57.810, Speaker B: And this deal will be stay on filecoin network with a certain time, which is the lifetime now minimum is 180 days. And possibly something might go wrong with the sector. Sector might go down because the storage provider has some issue maintaining that.
00:18:57.810 - 00:19:40.334, Speaker B: And so after you're making a deal successfully on filecoin we need to constantly monitor these deals. So first making sure all the sector are healthy enough and then the deal isn't expired, or if the clients want to store multiple replica and want to make sure that that's enough applications exist on Falcon Node, all this has to be monitored through smart contract or through what we call Ros Node as well. So if anything goes wrong, we need to make sure that we kick off another storage deal to repair or to renew based on what we service, what the developers are building on.
00:19:40.334 - 00:19:58.982, Speaker B: And then if you are interested, if you want to know more, here's the QR code as well. You can scan and then go to the spec page that we have been preparing. I've got to show system aggregation, spec page and also the storage deal renew process as well.
00:19:58.982 - 00:20:17.306, Speaker B: And keep in mind, this is just the starting point of preparing a spec and we are providing the minimum features required to be able to make the storage renew or storage application works. And obviously there are a lot of more detail could be added in there. And if you're interested, go find it out.
00:20:17.306 - 00:20:35.634, Speaker B: Find out and then do expanding that knowledge. All right, so let's talk a little bit more into the detail on each part of this, how it works. And I'm not going to spend too much time talking about how to make a storage deal through aggregator because Matt has covered it last time.
00:20:35.634 - 00:20:59.466, Speaker B: So I'm just going to go over very quick. And the example here, making storage deal through aggregator. The important part comparing with what Matt talked about is we bring the application part, which involving updating data, uploading data to aggregator and then be able to submit the CID to aggregator as well.
00:20:59.466 - 00:21:18.400, Speaker B: At the same time, it might need to register the renew job or replication job or repair job with what we call Ros Node in the future. And then Rosnode will be able to monitor those. And that's what we expect developers or we expect builders to build for this.
00:21:18.400 - 00:21:38.626, Speaker B: Maybe it's going to be a part of the perpetual storage part of the storage service that they are working on. And then the process are quite simple. And if you're making a storage deal with aggregator, you're going to submit your data and submit your CID to aggregator.
00:21:38.626 - 00:22:13.070, Speaker B: And then aggregator smart contract will be able to monitor that if they received a request of storing data and they're going to emit events of receive a request. And once the request come in and have enough data to pack into one sector, the aggregator will do the job and then aggregate all the deal, generate the parsi and then be able to call back the complete function. So the complete function will record the proof and then the deals including the CID in the aggregator smart contract.
00:22:13.070 - 00:22:55.262, Speaker B: And that will be able to be encrypted by the nodes as well as the smart contract which I will cover next. And this is the process of making storage deal once your storage deal is finished and then the gregator Smart contract will be able to record all the deals have been made for that CID and included that CID into the deal process. And that's the first step of making storage deals with greater keep in mind that we are taking a filecoin data tool edge as the example here and if you're interested, you can also use them as well.
00:22:55.262 - 00:23:21.542, Speaker B: And there's a smart contract having provided by aggregator and has a submit function, a complete function. That I demonstrated talk about in this diagram and also have a get audio function will be eventually used by the deal status smart contract as well. And once the deal is made successfully on chain, the next step will be.
00:23:21.542 - 00:23:36.940, Speaker B: We'll keep monitoring those deals and if something goes wrong, the Ros node will be able to take actions here. I'm going to take replication and renew as example. And repair will be coming later as well.
00:23:36.940 - 00:24:17.138, Speaker B: So if you remember earlier I said when application make a storage deal and you can also register a renew job and replication job with Ross node with this note. So eventually this note will work with deal status smart contract and monitor those deals on filecoin through the aggregator. So how that works is there's a deal status smart contract in a smart contract and you're going to get all the active deals through the aggregator smart contract.
00:24:17.138 - 00:24:43.966, Speaker B: So we send a request to the aggregator smart contract and get a list of the deals that, including the CID, have made on chain. And then they will check with Onfalcoin network, calling the building actors to look if those deals are still active or not. And once they get data back and it will emit events about which deal is active or not.
00:24:43.966 - 00:25:23.046, Speaker B: And eventually the Rosner will be able to listen to those events and then calculate if there are enough active deals exist for this CID. So if not for example if the clients want to have ten replications on the file coin but we can only find nine active deals which means this is one missing and it could be a repair and a replication as well. So the rust node has to take action to start a replication work or start a repair work kick off not a new proposal with aggregator and activate idea for these kinds.
00:25:23.046 - 00:25:48.498, Speaker B: This is the brief process which involves a lot of monitoring, a lot of customer logic into replication as well and that works the same for the renew job. The only little bit difference is on the deal status contract we are going to look at is there any deal expires within certain APOC. And those list of deals are also request from the aggregator smart contract.
00:25:48.498 - 00:26:17.978, Speaker B: And you'll? Be able to get a list of deals that have been made to include that CID in. And for each of the deals, we'll look at the building actor and to look at the deal term to make sure if it's expired or not. If it's close to expire, we're going to emit events and those expired deals events will be listened by the Ross Note and Ross Note will decide if there's a new deal needs to kick off to do the renew.
00:26:17.978 - 00:26:43.398, Speaker B: And all these are the brief process of what a deal monitor and what Ross node should do. So like I mentioned earlier, this is a very minimal features that we have put into the spec to make sure that this renew as a service or replication service works fine end to end. But obviously there are more that we can add into this future.
00:26:43.398 - 00:27:09.806, Speaker B: For example, if we look at the deal status smart contract, currently what we design it for is for what the client has stored for the CID and this contract will be able to get a list of the deals and keep monitoring those deals periodically. So there are two functions that we provide. One is get active deals which we are used to determine if there are enough replications for this CID on chain.
00:27:09.806 - 00:28:08.434, Speaker B: And then the second one is get expiring deals which is used to determine if there's any deal expiring that we need to renew for it. So this is a very basic function, but if you think about more and you probably will get out. But when exactly should I monitor those contracts? When exactly should I monitor the deal? Do I need to get Oracle into the picture? How do I do a Chrome job to make sure that I don't run that status check too often? And maybe if there's new renewing repair coming, what's the logic should I do right? Should I renew based on what the clients ask for? Or maybe I can renew in a different location and pick the different storage provider to do that and how to pay, how the clients will pay the renew service or repair service.
00:28:08.434 - 00:28:24.970, Speaker B: Those are a lot of more detail you can add. And I think for this kind of a renew and repair Ros service deal and for the Ros node as well. And we'll design the Ros node as the point of being able to monitor the deals we have made.
00:28:24.970 - 00:29:11.142, Speaker B: Through the aggregator and also be able to help monitor the expiring deals or active deals and actually kicking off the job of renew a deal or replica deal or repair deal with aggregator or not aggregator on filecoin. All these are very detailed spec are included into this QR code if you scan and you'll be able to find it and that's the part we are pulling it out. And if there's any developers are interested into building replication renew as a service and you can go follow and go through this note and read this aspect and welcome anyone to build it for it.
00:29:11.142 - 00:29:43.654, Speaker B: And if you're building a perpetual storage or if you're building a storage service you're also interested to build this and also very welcome to do so. Feel free to reach out to us if you have any question and all this documents has been put it out into our link to Tree. If you are interested you can scan and get all the information we are looking for like aggregator aggregator specs or this renew repair service spec and also can follow us on Twitter.
00:29:43.654 - 00:30:22.602, Speaker B: We have a twitch happening every month to talk about all this to detail. I think I first think I might only 30 minutes, but after I'm going through, it feels like a lot of information to digest. And I hope after this session you'll be able to go back and have the picture of how the deal process on filecoin looks like and maybe have the aggregation in why it's needed and have the clear picture of why we need a renew, why need to repair, why need to replication into that picture.
00:30:22.602 - 00:30:36.740, Speaker B: And if you are interested in building it just keep following us and if you have any question maybe you can ask now or maybe ask us on Slack or Discord. Okay, that's all my content for, thank you.
00:30:37.510 - 00:30:58.330, Speaker A: Cheers Longfei. Yes, if anybody has any questions please feel free to type them in the chat now or take yourself off mute and ask. And as Longfei said, if you don't have anything now, please definitely take advantage of the discord partner channels as well to reach out to Longfei and other partners via that route.
00:30:58.330 - 00:31:17.674, Speaker A: Okay, if there are no other questions or no questions, thank you Longfei for the great presentation and thank you everybody for attending and yeah we will see you all later. Cheers, have a good one.
00:31:17.872 - 00:31:18.520, Speaker B: Thank you everyone.
