00:00:00.650 - 00:00:06.222, Speaker A: Yeah, I'm so good at these things. All righty. Yeah.
00:00:06.222 - 00:00:27.080, Speaker A: First of all, big thanks to Robert and to Alex, our wonderful host, because I had very little time to prepare this presentation because of a busy week and not dealing well with the COVID vaccination. But here we are. And yeah, I'm ready if you are.
00:00:27.080 - 00:00:30.598, Speaker A: Should I go ahead and start?
00:00:30.684 - 00:00:34.534, Speaker B: Yes, please, you can go ahead and start. We can see your screen and we can hear you very well.
00:00:34.652 - 00:00:44.090, Speaker A: Perfect. Yeah. So we've already heard a lot about how mev extraction works on other blockchains today.
00:00:44.090 - 00:01:16.098, Speaker A: And I'm just here to give a little summary of what we've heard today, a little overview and how these things all tie together. First of all, why block space markets? I think good to start from a high level perspective, in blockchains, we have a limited amount of block space. We constrain this so people can still run full nodes and validate the current state of the blockchain.
00:01:16.098 - 00:01:26.962, Speaker A: However, there can be potentially unlimited demand for that block space. We've seen this on Ethereum many times here. Ethereum is a whale chain.
00:01:26.962 - 00:01:45.710, Speaker A: Right now, I think gas fees are above 300 gray. So we need some way to match this demand with the available supply. And that's not an easy problem because we need to figure out two things.
00:01:45.710 - 00:02:11.320, Speaker A: First, we need to mediate access, so who gets into the block at all? And for the longest time in crypto, this used to be actually the only problem. Like people only cared about getting into a block. But dtmev we sort of see a secondary problem come up, and that is transactions increasingly want to be mined at a specific target position.
00:02:11.320 - 00:02:30.534, Speaker A: So the original problem of just inclusion in a block used to be quite easy. People were concerned about underbidding, and if they underbid their fee, then they would have to wait longer for inclusion. Maybe their transaction would fail.
00:02:30.534 - 00:02:44.542, Speaker A: So maybe if they want to buy something from unisorp and they underbid, then the price might have already moved against them and then their transaction fails. So this happens. And if they overbid, then of course they paid more than necessary.
00:02:44.542 - 00:03:14.300, Speaker A: So in both cases it hurt market efficiency, but it was ultimately not that hard of a problem to fix. So Created EIP 1559 and what ERP 1559 does is basically it tells the user how much to bid. So basically it quotes a price where if the user is willing to pay that price, they're definitely getting included and that price is almost never higher than it needs to be.
00:03:14.300 - 00:03:41.202, Speaker A: There's a great article by Pintail if you haven't yet read it, who recently analyzed if ERP One Five F Nine has fulfilled these objectives of preventing underbidding and overbidding. And he came to the conclusion that, yes, it has, and it's actually a really good read. It shows that a lot of the users who today use the ERP One Five Nine format I e.
00:03:41.202 - 00:04:07.354, Speaker A: They outsource their bidding strategy to ERP one five nine. They consistently pay less for their transactions than those who still use the legacy. So, block space market used to be easy, but mev has made it hard again.
00:04:07.354 - 00:04:23.374, Speaker A: Why? Because we now have the secondary problem of transactors wanting to express preferences on where exactly they want their transaction to be included. And mev is a really big economic force. So we see.
00:04:23.374 - 00:04:39.774, Speaker A: This is an absolute minimum amount on mev that has been extracted. It's just like an extremely defensive gas by flashbacks. But as we can see here, even $800 million since 2020, and this is a substantial part of minor revenue.
00:04:39.774 - 00:05:01.530, Speaker A: So as a minor, you can't not care about mev. And not just as a minor. This is just a huge honey pot that attracts a lot of searchers and financial firms to compete for these arbitrage opportunities, liquidations, et cetera.
00:05:01.530 - 00:05:25.122, Speaker A: And as a result, unfortunately, of this mev extraction there we have seen some negative externalities that have arisen. So in the short term, we have seen more. And this is actually not very logical the way.
00:05:25.122 - 00:05:54.054, Speaker A: So this should actually come before. So we can see that the choice of the market mechanism, it informs a certain mev market structure and we will go into a bunch of mev market structures or market mechanisms soon and see the results. And these market structures, they lead to certain negative externalities and these can include ones that are quite short term in nature.
00:05:54.054 - 00:06:44.874, Speaker A: So, for example, if you have a market mechanism that allows for very finely grained expression of where you want your transaction to be mined, then the result is that it leads to, for example, much more mev extraction, period, right? And users might care about this specifically because it could lead to more sandwich attacks, more front running, more exploitation of NFT drops, et cetera. So this is very problematic. But if there's no way to express your preference, then it might lead to a lot of wasted block space, because if you have $800 million of mev on the table, then searchers and miners are going to use some way to extract that money.
00:06:44.874 - 00:07:18.550, Speaker A: So it's just a matter of how and what are the negative externalities of their approach. And in the long run, we have to be very concerned about concentration in both the block producer and the block builder cell. So, for example, if miners start to extract all of the mev themselves, then this massively raises the barrier to entry to be a miner and really hurts the decentralization of the blockchain to the point where there might only be one miner who can compete, because they have the dominant mev strategy and they are all proprietary in nature.
00:07:18.550 - 00:07:51.654, Speaker A: But equally, you can have a really decentralized block producer set. But there's one searcher, for example, one financial firm that sends their blocks to all the miners and that firm is so much better than everybody else, that even if they started censoring some users over others, they would still be so profitable that people cannot do anything against it. So miners don't really have a choice to switch to a different producer who doesn't censor.
00:07:51.654 - 00:08:09.986, Speaker A: So it's actually really important that the market for mining and the market for searching that they both stay reasonably competitive. So we know we want to minimize these negative externalities. Question how? And the answer is via backward deduction.
00:08:09.986 - 00:08:39.810, Speaker A: So we go from these negative externalities, we see how they arise from certain mev market structures and these tend to be the result of specific choice of the mev market mechanism. And in the wild we have seen a bunch of different of those and we had some time to study them. So on Ethereum, for the longest time we used to have transparent batched auctions, also called PGAs priority gas auctions.
00:08:39.810 - 00:09:07.500, Speaker A: Today most mev extraction has moved from PGAs to sealed bit batched auctions that happen in the flashboards relay. We have seen some chains, for example, Arbitrum experiment with first come, first serve approaches. So they have a single sequencer and that sequencer processes transactions in the order that they have first seen it.
00:09:07.500 - 00:09:33.410, Speaker A: And then finally another popular approach is that of randomization. So you collect orders, you batch them same as in PGA, but then you randomize them once. So I think a chain that does this might be, I'm not actually sure if any chain does this right now in the wild I know it's on NIA's Roadmap, I think it's on Osmosis Roadmap.
00:09:33.410 - 00:09:55.558, Speaker A: But this is definitely like an approach that has been known for a long time and we can understand the dynamics that it would create. So we will go through some examples now of how the market mechanism informs the dominant strategy and creating following negative externalities. So, Ethereum used to have a PGA.
00:09:55.558 - 00:10:27.154, Speaker A: PGA means that basically all of the bidding, both for inclusion but also for the position in the block, tended to happen inside the public mempool and priority was simply mediated via the gas price. That's why they used to call it the priority gas auction. So if you wanted, for example, to be on top of the block, then you just paid a very high gas price because miners would sort all of the transactions by gas price.
00:10:27.154 - 00:10:46.162, Speaker A: They had this very simple sorting algorithm basically. And if you saw a transaction and you wanted to front run the transaction, then you looked at the gas price of that transaction and you just bid very slightly more. Okay? So you would be inserted right before, et cetera.
00:10:46.162 - 00:11:22.126, Speaker A: And for back running you used to slightly underbid and so on. But the problem here was that the bits of like as everybody saw each other's bits, there was a very big incentive to just constantly update your bit. So this caused a lot of strain on the P to P layer and the mempool and it was a game where as a searcher or as an mev extractor, you needed very good latency and you needed a very good view of the transaction pool, so you always knew when you had been outbid.
00:11:22.126 - 00:11:47.760, Speaker A: So it was a game very much of speed and what it led to was a lot of failed transactions because even though searchers knew when they were outbid and they could sort of replace their transaction with one that paid very little gas, still this did not work all the time in practice. And so about, I think for some time more than 5% of block space was actually filled with failed transactions in Ethereum. So this was not great.
00:11:47.760 - 00:12:47.898, Speaker A: Because of the high unreliability in extracting mev, it created a significant incentive for vertical integration. So vertical integration means that a producer owns all layers of the supply chain and the supply chain in mining is basically the order of transactions in the block, right? So if you look at flashboards today, then you basically have the opposite of vertical integration and you have division of labor where miners receive at least part of their block ordering from a specialized marketplace that tells them which mev transactions to include. Right? And this is sort of public for all the miners, but this is not the standard outcome like the guaranteed outcome, right? So this is something that you have to actively work towards.
00:12:47.898 - 00:13:33.134, Speaker A: And in PGA, because of the high unreliability of mev extraction, basically there was a big incentive for miners to just start extracting mev themselves and not just high unreliability. Also if the market for searching is not very competitive, so there are very few searchers and they control a lot of the mev activity, like a certain opportunity such as front running, then the result is that these searchers are the price setters, so they can pay a very low because they have no competition, right? So they can pay a very low amount of their revenue to the miner. And this further increases the incentive for the miner to just extract the mev themselves.
00:13:33.134 - 00:13:58.950, Speaker A: And we saw this, I think there was a time where some mining pools started to extract their own mev and they eventually most of them stopped doing this and instead adopted flashboards. But without flashboards, this is some of the outcome that could have happened. However, I said a lot of good things about Flashbards.
00:13:58.950 - 00:14:16.830, Speaker A: So we are with a sealed bid auction mechanism. And what this does is everybody basically only submits one bid instead of many. So your incentive now, because you can't update your bid, is just to bid the highest that you're willing to bid, which is very good for the miner.
00:14:16.830 - 00:14:37.090, Speaker A: And instead of competing on latency, now all of a sudden the searchers are competing on gas efficiency. So they want to create or finish their arbitrage opportunity or their MEB transaction with as little gas as possible. And this is great for users, right? Because it frees up a lot of block space on the chain.
00:14:37.090 - 00:15:08.080, Speaker A: However, there is one negative externality here as well, which is simply that because it is now so easy to express preference on your transaction and stay exactly where you want to be mined in the chain, that this leads to more mev extraction, period. And this has some negative externality on the users who suffer from more sandwich attacks. Another example, how much time do we have left, by the way? That would be quite.
00:15:10.450 - 00:15:12.286, Speaker B: Ten minutes or so, maybe a little.
00:15:12.388 - 00:15:14.062, Speaker A: Okay, that's perfect, that's perfect.
00:15:14.196 - 00:15:19.214, Speaker B: We want to leave like 15 to 20 minutes for question and it's 37, so let's say eight minutes.
00:15:19.412 - 00:15:28.382, Speaker A: Okay. So, another example here is BSc Binance smart chain. So Binance smart chain is very similar to Ethereum.
00:15:28.382 - 00:15:42.950, Speaker A: It also has public mempool. Basically, it just has a lot bigger block size and shorter block time. So I think block time on BSE is around 5 seconds.
00:15:42.950 - 00:15:56.960, Speaker A: And the block size is I don't know how big, but really big. So it's a chain that has very low fees and it has a very concentrated validator set. I think it has eleven validators who are all owned by Binance and friends.
00:15:56.960 - 00:16:25.558, Speaker A: And what this leads to is also PGA, because there is no how you can think of sort of the flashboards mechanism is almost like a side channel that exists next to the public mempool where you can express your preferences about where you want to get mined. And this happens in an environment where it's performed with very few negative external analyses. But BSc still doesn't have such a system.
00:16:25.558 - 00:16:44.742, Speaker A: So what instead happens is pretty much the same that we saw on Ethereum. However, with even sort of less bidding, it's just more spam. So I think Robert he made a good tweet the other day about a block in Ethereum.
00:16:44.742 - 00:17:17.394, Speaker A: No, about a block in BSc that had, I think on average a block on BSc has between like one point five K and two K transactions in it. And that particular block had around 1000 transactions that were all competing for the same Arbitrage opportunity and only one of them was able to fill it. And all of the other 1000 transactions failed and actually wasted more than half of that entire block.
00:17:17.394 - 00:18:11.442, Speaker A: Right? So that's a clear negative externality because these searchers, they are going to fight for this Arbitrage opportunity because it exists, but they basically pay, they compete in an auction and they pay sort of with failed transactions. But this is a cost that has to be borne by users, basically, that they're not compensated for. And the outcome here for market structure is kind of the same that I alluded to earlier with Ethereum, which is that if you don't have a market where searchers can, if you don't have this permissionless site channel that every validator can adopt, where they communicate with searchers, then the outcome is that you might see vertical integration.
00:18:11.442 - 00:18:31.338, Speaker A: So meaning that the validators start extracting the MEB themselves. This is not really a big deal at all in BSc because BSc doesn't have the same, it doesn't have the same agenda in terms of decentralization. Right? So they don't claim to be as decentralized as Ethereum.
00:18:31.338 - 00:18:50.446, Speaker A: They know, of course that they have concentrated validator set and this is not a big problem. And so this can actually be fine in this case. However, the way it's a block space, I would say that is still an issue, especially when the network can get really overloaded.
00:18:50.446 - 00:18:59.990, Speaker A: At some points. We briefly touched on arbitram. Arbitrum as a single sequencer, they use first come, first serve.
00:18:59.990 - 00:19:40.930, Speaker A: What happens here if a bunch of searchers see the same, for example, Arbitrage opportunity, so someone traded on a Dex and then the state of the Dex on Arbitrum is different from the state of the exchange on Binance, and so they want to perform an Arbitrage opportunity. So in this case we still know that they will do everything that they can in order to satisfy this opportunity. However, we know definitely that they will just try to spam as hard as possible, but mostly I would say it's a game of latency.
00:19:40.930 - 00:20:23.650, Speaker A: So they want the optimal network location and the closest proximity to wherever that arbitrary sequencer is. And if sort of trading on traditional exchanges and high frequency trading is any guide, then I think the end game for all of these things, where you have a single sequence and they sort basically by latency, then the final outcome is always a massive incentive towards colocation. So that means basically you being in the same room with the sequencer and the sequencer can sell these co location spots.
00:20:23.650 - 00:20:56.394, Speaker A: So on the one hand, this again leads to wasted block space, but on the other hand, very high barriers to entry, both in the market for sequencing. So if Arbitrum ever wants to decentralize the sequencer, then sequencers might have an incentive to offer such colocation services. And this might not be available to everyone, but also to searchers.
00:20:56.394 - 00:21:20.734, Speaker A: Right? So if you don't have access to very high latency or to colocation, then this basically is very bad for the searcher market and finally the randomized batch auction. So here the case is actually quite clear. So you have 100 transactions in a block and you know you're going to get randomized.
00:21:20.734 - 00:21:41.350, Speaker A: Then you have two ways. Either you fill up as much of the block as you can with that transaction that you must get mined, or you coordinate with the miner to just ignore transactions that would in any way be competitive with you. Right? So the dominant mev strategy here is just censorship.
00:21:41.350 - 00:22:01.438, Speaker A: So excluding some transactions that might pay a sufficient fee but would reduce the probability that your mev transaction would succeed. Yeah. And this once again, especially the spamming, it leads to waste of block space, and the censorship.
00:22:01.438 - 00:22:24.810, Speaker A: There is an incentive here, again, for vertical integration because it's actually very hard for searchers to extract mev here in this scheme without spamming. So I think this leads to concentration in the block producer, block builder set as well. And, well, the takeaway is kind of show me the incentive and I will show you the outcome.
00:22:24.810 - 00:22:58.450, Speaker A: If you build a certain market structure, then this market structure better adheres to the realities of the market, which is that there is mev on the table of a certain value. And so searchers and miners both will do whatever they can in order to extract this MEB. And if your market structure doesn't consider that, and in many cases it doesn't, that was the point of the second or third slide.
00:22:58.450 - 00:23:45.614, Speaker A: Because in the past, our market structures, our blockchain market mechanisms, only really cared about inclusion. And like dealing with inclusion well, but not dealing with the exact position in the block very well, then you get extraction strategies and me market structures that create a lot of unforeseen negative externalities. And yeah, here's sort of a great example of that because right now we have this climate crisis, but at the same time, a lot of airplanes are sort of basically forced to do these unnecessary flights because otherwise they would lose their landing spots in airports.
00:23:45.614 - 00:24:09.478, Speaker A: And this is one of the most extreme examples of just bad market design driving extreme negative externalities. So takeaways I summarized it here for you, the dominant mev strategy and these market mechanisms takeaway, yeah, we touched on this. Mev is inevitable.
00:24:09.478 - 00:24:41.370, Speaker A: So the marketplace as a marketplace, then I should think very hard about the long term consequences of your design choices and build mechanisms that adhere to the realities of the market, not in utopia where mev doesn't exist. And app designers don't rely on marketplace designers alone, because we have seen, actually in the last year, some big innovations on the application layer. To give just two examples.
00:24:41.370 - 00:25:00.726, Speaker A: Maker Dows Liquidations 2.0, instead of having a fixed amount, like a fixed reward for liquidators, you have a reverse Dutch auction. So the amount that you get for liquidating, it starts from zero and then it goes up every block.
00:25:00.726 - 00:25:29.310, Speaker A: So you get liquidated at the best possible price and the lowest possible mev. And second, unisop v three, because it allows market makers to concentrate their liquidity around a certain price point, it has greatly reduced the price impact of many trades that users have and thereby greatly sort of reducing the amount of sandwich attacks that happen. So this is really positive.
00:25:29.310 - 00:26:00.160, Speaker A: Both, I think mostly the responsibility to protect the users from mev still lies at the application layer. And so we hear a lot about chains that protect the users from mev, but in reality is that mev will find a way just with very negative externalities on the users. Thank you.
00:26:03.810 - 00:26:06.780, Speaker B: All right, awesome. Thank you, Hassan. That was great.
