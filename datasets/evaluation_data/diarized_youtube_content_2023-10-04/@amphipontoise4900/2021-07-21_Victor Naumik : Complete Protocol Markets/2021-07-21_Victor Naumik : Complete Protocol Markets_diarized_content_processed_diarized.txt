00:00:19.540 - 00:00:23.428, Speaker A: Okay. Hi everyone. I'm on complete protocol markets by Euler.
00:00:23.428 - 00:00:47.010, Speaker A: So we have two of us here, Euler engineers, victor, who is co CTO at Euler, and myself, Tamash Danchek, and we'll introduce you today to the world of blockchain protocol markets. Prepare some construction and we'll go first through the challenges that we've seen, that we see, and then for some solutions that we provide.
00:00:49.860 - 00:01:31.944, Speaker B: Okay, so let's start with a question. How do we value different blockchains? Like when you hear somebody said that this blockchain is better than another blockchain, what do you hear? Usually people tell about how many transactions are there per block or per day, how much value is there, how many people use it, and all this different stuff. That's kind of an outside perspective of valuing the blockchain that you can go for example, to Etherscan and just check these values.
00:01:31.944 - 00:01:42.640, Speaker B: But what we are going to tell you today is more about how to value blockchains from the inside, from the blocks perspective. So I'll give the mic back to Thomas.
00:01:43.620 - 00:02:29.788, Speaker A: Yeah, so this is a big challenge possibly. So first of all, you want to understand what value is in the native cryptocurrency, but you also want to have some view on the health of the protocol and ideally to introduce the way of trading that protocol, to be able to read that within the transaction that is in the DeFi system itself. So like the DeFi solution, being able to understand how the environment of that DeFi solution behaves, is it healthy, does it process a lot of transactions? Is there value inside? And if I go back a few years into when I was switching myself full time to the blockchain space, I was taking some notes on the ideas of blockchain native derivatives.
00:02:29.788 - 00:02:52.356, Speaker A: And I think this is something that could be used as a name by many people for many different things. But I try to define it for myself as something that's observable on chain. When you think about the underlying of a derivative product, it can be priced on chain, not only because there is data there on chain to price it, but also because the tooling and the algorithms are viable on chain.
00:02:52.356 - 00:03:15.970, Speaker A: So you can execute them within the gas limits and it can be settled on chain. So you have all the tooling around the smart contract that allows you to use that price information, to use the data from the blockchain and calculate what's the payout of the given financial instrument. And this is pretty achievable nowadays with Ethereum and we'll show how.
00:03:15.970 - 00:03:34.164, Speaker A: So first we think how to get rid of this, like being able to observe on chain, how to get rid of the risks of bringing data from outside of the chain. So trying to go or lacklust by first removing any off chain oracles. So things that bring the data from the outside world.
00:03:34.164 - 00:04:02.844, Speaker A: So you don't want to trade gas prices on chain but learn about what the gas prices are from the Oracles that observe the blockchain from the outside world ideally. So you want to have a look internally and similarly for the transaction flows for any information about how much data we have there want to go on chain. But even on chain you have some kind of like Oracles that are wrapping some other off chain Oracles.
00:04:02.844 - 00:04:32.280, Speaker A: So there are things that are deriving its value based on some pegs or information about the value of the collateral. Simply the data from the off chain world built to the on chain and then wrapped into a DeFi protocol and then itself on chain. Things that do provide pricing like uniswap and they can be reliable, they belong to the DeFi world, but also they bring all the risks of things like flash loans, manipulation and so on.
00:04:32.280 - 00:05:01.170, Speaker A: So what we want to rely on is the onchain parameters or the onchain parameters and the onchain parameters that are read from the protocol, from the transaction environment, from the block environment and they unfortunately also can be manipulated. And we'll talk about it a bit today and we show also some ways of preventing it and bring some better pricing and maybe Victor will say about the work that's been done to extract that data.
00:05:02.180 - 00:05:40.590, Speaker B: Yeah, so usually like, you know, blockchains contains blocks which contain headers and headers contain some parameters and in Ethereum you can extract the parameters from the block, but the limitation is that you can only extract the current block like difficulty or gas limit or timestamp. So the problem is sometimes you need more than current blocks, sometimes you need to look at the past. So we developed a system that allows you to extract information from blocks back to 256 blocks in the past.
00:05:40.590 - 00:06:20.620, Speaker B: To use it, user needs to send block header LLP encoded to the smart contract and then the smart contract will extract the parameters from header, from LLP verify. And if the hash of the LLP is equals to the hash of the block, then everything is correct and it's verified and proven that these parameters come from this exact block. Currently the limitation is last 256 blocks, but there are AAPS that propose to prolong it further in the past and that will be really great.
00:06:20.620 - 00:06:34.032, Speaker B: But currently it's this. And also one more thing, interesting thing that can provide internal values is from a smart contract. And I want to ask you a question now.
00:06:34.032 - 00:06:44.392, Speaker B: What is the most important smart contract on the Ethereum? What are your, if you stay contracted?
00:06:44.476 - 00:06:45.552, Speaker A: Deposit contract.
00:06:45.696 - 00:06:48.464, Speaker B: Bingo. Bingo. Yes, deposit contract.
00:06:48.464 - 00:07:33.570, Speaker B: So it has, as you know, money from Ethereum deposited into this contract and this money is locked and kind of it brings us the thought of how people value this transition to e two. And by observing how much value is there, how quickly it grows, we can observe how users really react to it too. Okay, so now thomas will tell about what was in the past that enabled us to do all this that we do.
00:07:34.500 - 00:07:55.368, Speaker A: Yeah, sure. So when I think about the blockchain protocol markets, if I say that few years ago I was thinking about blockchain native derivatives and I was thinking about observing gas prices, it was not really possible to observe gas prices without falling into a risk of reading something that was massively manipulated by the miners. And also some other things were not available.
00:07:55.368 - 00:08:09.612, Speaker A: And this is a short path, but actually last few years of obvious big things. So AMM stable coins and nowadays just around the corner, starting on 4 August on Mainet, the base fee. So part of VIP 1559.
00:08:09.612 - 00:08:33.840, Speaker A: So we needed all of those building blocks to be able to bring something that will be pricing for derivatives, that will allow us to trade and will allow us to read the most important parts of the system. And now let's think about these examples of the manipulation and how exactly they play out if we build some products around it. So for hash rate and for gas prices.
00:08:33.840 - 00:08:56.412, Speaker A: So hash rate after the merge, after Ethereum two happens, does not exist anymore. But it serves us as a great example of showing how we build the system, our build day, something that will show later as a forwards construction and also what kind of manipulation you can expect from players in the market. And for gas prices, similarly, IP 1559 changes a lot.
00:08:56.412 - 00:09:25.200, Speaker A: So you can no longer include any transactions of any value without bearing any costs as a minor. But still after IP 1559 and there are some things that can be manipulated, you can simply push the base fee up or show it in a moment. So, as for hash rates, these are results of the simulation that was running and it uses the actual algorithms from the protocol, from the consensus in Ethereum.
00:09:25.200 - 00:09:40.008, Speaker A: And it shows you that those charts are almost looking identical. They're not identical, but they show that we can use difficulty as a proxy for the hash rate. So when the hash rate grows up, the difficulty will go up, when the hash rate goes down, the difficulty will go down.
00:09:40.008 - 00:10:06.180, Speaker A: And this is slightly delayed, which we'll see. But this is an example of what happens if you have a minor switching off, like mining pool switching off 10%, a bigger mining pool that has 10% of the hash rate deciding to switch off their miners. So they remove the 10% of the hash rate and the difficulty slowly goes down over 24 hours it will adjust and will go 10% down.
00:10:06.180 - 00:10:36.728, Speaker A: But what's the most important part is these first few hundred blocks, they cost not that much. If you look at the short term cost of the 1% drop of the difficulty, it's around 2030. If to push it 1% down, if you have above 1% of the mining hash power, then you can make some temporary adjustments to the difficulty that can manipulate the payouts based on the settlements of some derivatives that would be entirely traded on chain.
00:10:36.728 - 00:11:05.060, Speaker A: And similarly, even if you would observe that from the outside of the chain, you can do the same, obviously. And as for the gas price manipulation after EIP 1559, so you see at the bottom, we have 30 blocks and just over 30 blocks, which is 30 times 12 seconds. It's around six minutes, right? Over six minutes, we can push the gas prices from base fee from ten GUI to 400.
00:11:05.060 - 00:11:29.484, Speaker A: So it's 40 times increase of the base fee and it costs around $200,000 nowadays, ethereum value, right. So the cost is here really for the temporary growth. You pay around $500 per one way of the base fee growth and you can keep pushing it as long as you have money for that.
00:11:29.484 - 00:11:46.704, Speaker A: But obviously then the network immediately starts reverting back to the actual market base fee. So it's expensive. But if you have settlement of a derivative that is relying on this value, then it may actually bring a lot of value to whoever manipulates the price.
00:11:46.704 - 00:12:09.992, Speaker A: As for pushing the base fee down, it requires collusion of the miners. So this is less of a scenario that would be worried about because it has much wider ramifications than simply trading on DeFi protocols. As for deposit contract, and this is particularly interesting scenario for us, it's really hard to manipulate when you look at the numbers that are taken into account here.
00:12:09.992 - 00:12:17.996, Speaker A: So we have something like 0.7 million of Eve deployed in the last month only. So it's a huge amount of money, like $1.5
00:12:17.996 - 00:12:43.020, Speaker A: billion, and even a single deposit is 32 Eve. So if we build the instrument that is settling based on the change, like over time change in the deposit contract value, then we have quite reliable market that we can build derivative instruments on top of. All right?
00:12:44.510 - 00:13:03.886, Speaker B: Yeah. And now I will tell you how we can deal with these manipulations, because as you've seen, they're purely mostly just instantaneous and very short. So to deal with that, the first thing that comes to mind is just averaging.
00:13:03.886 - 00:13:17.622, Speaker B: But as I've said, we only can average 256 blocks. So that's probably not enough because you've seen the graphs and we need more. So we have two ideas, two solutions right now.
00:13:17.622 - 00:13:54.930, Speaker B: One is just piggybacking on user transactions, like when somebody trades or something, we just add some instructions to store the values on chain and use it later for averaging. Or we also were working with a solution on Cairo in contribution with Starquare, and it's zero knowledge proof of program execution. So you can just push a lot of blocks there, it will prove it and contract will verify it.
00:13:54.930 - 00:14:20.794, Speaker B: And that way you can do averaging. So right now, let's take a break from theory and tell about the binary options. This is the product we were working on for the last several months and why binary options? There have many pros, many cons.
00:14:20.794 - 00:14:47.150, Speaker B: The pros are for example, that the payout is same for everyone and also they can be exercised simultaneously for everyone. If just one person pushes the exercise transaction, that saves a lot of gas, that saves a lot of nerves for people they don't have to monitor just it's like crowd mind pushing one transaction and that's it. They are all exercised.
00:14:47.150 - 00:15:29.438, Speaker B: Also, binary options can be fully collateralized, which means that for one option, for example, is one dollars collateral and you have no risk of overpaying if you just pay this one dollars. But also there are cons, for example for this fully collateralized thing it requires to lock capital upfront. Also the liquidity providers take a lot of risk here because option, no matter which price it starts like half a dollar or whatever, at the end of the expiration it goes or exercisement, it goes either up to $1 or down to zero.
00:15:29.438 - 00:15:50.114, Speaker B: So the price never comes back to where it started. So liquidity providers have a lot of losses and also there are possibilities to manipulate this AMM by for example flash loans, Minting, a lot of options and training it against the pool. So liquidity providers suffer.
00:15:50.114 - 00:16:26.930, Speaker B: Again, we tried several approaches to mitigate these problems like the Tata functions or just rising the fees of the pool. So liquidity providers get more of the fees and traders trade have to pay more for these manipulations. But anyway, we have the product, we just launch it like we deployed it maybe like 15 minutes ago and you can test it right now if you go to Alpha Euler network from your mobile or laptop.
00:16:26.930 - 00:16:38.070, Speaker B: Okay, and this is for binary options. And now we are working on another product which is more complicated, more interesting and it's about forwards.
00:16:38.890 - 00:16:59.034, Speaker A: All right? Okay. So with the binary options, we kept talking to people who are doing market making, who are trading ideas of hash rates and gas prices. And what we kept hearing was we need to market make it, we need to start with some more basic products, we need to start maybe futures forwards and keep building from there to the top.
00:16:59.034 - 00:17:43.558, Speaker A: And also working with the traditional finance specialists, we said okay, when we start with options and it feels a bit like everyone started with options in the markets in ethereum and it's really hard to build from there and do the proper market making. So we introduced the construction of forwards so agreements to buy or sell something in the future at the pre agreed price. So we're talking here about buying or selling hash rate or gas prices or even more interesting buying or selling the validators count, which if you think about it belonger, gives you the ability to switch like the floats to fixed on your exposure to the validator's yield on if to deposit.
00:17:43.558 - 00:18:13.426, Speaker A: So how do we construct the forwards. First, we'll start with the idea of the lambda, which is simply the exponent of the function that represents the forward price. We just showed that for the hash rate, we have the hash rate growth which is representing a bit of the technological progress over time, right? So you assume that the hash rate is growing slowly over time because of GPUs getting faster, because of asics being introduced to the market that are more efficient and so on and so on.
00:18:13.426 - 00:18:52.558, Speaker A: And this lambda can be higher or lower, then you have faster growth, lower growth. If lambda is negative, which can be, then it will be a fall of hash rate over some periods of time when you actually have the market slowly withdrawing from ethereum space. And now, if you look at the historical lambdas on ethereum so looking sampling every single block in the past, looking at difficulty, as we said, is a good proxy for hash rate those monthly lambdas were somewhere between -80% plus 80% and recently they are stabilized over the last two years.
00:18:52.558 - 00:18:58.322, Speaker A: In between like 20 plus -0.2 plus 0.2 so you would expect that over a month.
00:18:58.322 - 00:19:13.846, Speaker A: The hash rate will grow around up to around 20%, 25%, something like that. And if you look at the daily lambdas again, their mean over time is around zero. And they probably go up or down around 5% during the day.
00:19:13.846 - 00:19:31.710, Speaker A: The hash rate with obviously some standard deviations and some extreme movements over time. But what is important is that lambda itself is normally distributed and the hash rate itself as a result is normally distributed. And we can start building products based on that knowledge.
00:19:31.710 - 00:19:43.646, Speaker A: And we use something for pricing lambda. So what we introduce will be AMM. So the automatic pricer but what will be pricing will be pricing lambda itself.
00:19:43.646 - 00:19:56.500, Speaker A: So, in the same way as you trade if versus USD and if you buy if, then the price of if expressed in USD goes up. If you sell eve, then it goes down. What we'll be doing here is if you'll be going long forward.
00:19:56.500 - 00:20:13.274, Speaker A: So if you'd be going long hash rate one month from now, then the lambda will move up. So you'll be just pushing up this function, the exponential function. And then if you're selling so if you're shorting your position, forward position, then the lambda will be going down.
00:20:13.274 - 00:20:29.786, Speaker A: Why we do that because similarly in traditional AMMS, we want the pool to not move far away from the initial price. Because this is the most efficient thing for the liquidity providers. They can collect fees at the same time without getting too much risk exposure in any direction.
00:20:29.786 - 00:21:05.402, Speaker A: And the way we price lambda is we just apply a tangent fashion that will allow us to move it, to slide it between negative and positive infinity. And the way we build it is by introducing something that we call a m automatic NFT maker. So each time you buy a forward or sell a forward, what happens is we are minting an NFT that represents the contract, the forward contract, and that NFT has to be collateralized and it represents your forward position and the pool itself adjusts the lambda and in a way invites the market to trade against this position.
00:21:05.402 - 00:21:29.534, Speaker A: So if someone goes long, the lambda goes up and you try to do the market making you apply the spread and it'll be short, short, long, short, long positions. And one very, very important thing is the constant maturity on the pool. So what we've seen that was a big problem with any of the pools that are trading the derivatives was that very often they were trading something that was expiring.
00:21:29.534 - 00:21:50.182, Speaker A: Right? So you'd have an expiring instrument that has like one month from now and then the pool closes and you have this massive volatility towards the close. What we do is whenever you mint a forward in that pool, it's always one month from now. So it's not some date one month from now and then we're getting closer and closer to it.
00:21:50.182 - 00:22:03.360, Speaker A: After sometime it will be just one week to expiry. What happens is every time you trade on this pool you're getting a forward position that is one month from now. Or if the tenor, the maturity of the pool is different, it can be one week or one day.
00:22:03.360 - 00:22:30.976, Speaker A: And the longer the tenor, the bigger there is the exposure to the lambda function change and the shorter the more you're expressing the risk of the spot hash rate changing. How it settling for any of the blockchain protocol parameters so they are not really deliverable. So if you think about hash rate or gas prices, most of you think, you imagine that you cannot deliver those.
00:22:30.976 - 00:22:54.350, Speaker A: There are some solutions for physical delivery of hash rate or maybe like gas tokens for physical delivery of gas. But what we do is just introduce the cash settled forwards where you trade the difference between the pre agreed difficulty as expressing hash rate and the actual hash rate as it happens on the settlement date. Cool.
00:22:54.350 - 00:23:13.202, Speaker A: So as we said, there is a collateralization requirement for the trades that are entering the space. So any trader who will be trading against the pool will have a requirement for posting collateral. Whether you're going long or short, you need to ensure that you won't be liquidated.
00:23:13.202 - 00:24:02.920, Speaker A: So the protocol will be ensuring that the liquidations may happen if you're under collateralized as just calculated, depending on what probability we want to have to cover all the potential hash rate movement, this will be wider or more narrow branch and this is also related to the former volatility of the lambdas. So again, because of either we can approach it by slowly collecting the data, as we mentioned before, by piggybacking on orders like the same way as many protocols are doing that. Or we can start using the Kro proofs to bring to the chain data, like once per day to refresh the volatilities, to refresh the past averages to the more complex calculations of the products that are built on top of it.
00:24:02.920 - 00:24:34.106, Speaker A: So this is more like as a visualization for long term, that's how the shape looks on the right side. This is actual numbers with the one month lambdas they look almost linear, but this is actually this exponential function. And again, what are the two types of risks? One is the lambda change, so the change in the actual long term behavior of the curve, how the hash rate changes over time.
00:24:34.106 - 00:24:52.306, Speaker A: The second thing is the spot change risks. So this is the short term hash rate drops like immediate reaction to the market, the market change of the difficulty. And practically this is the kind of risk that the pool acquires if somebody trades against the pool.
00:24:52.306 - 00:25:24.296, Speaker A: So the liquidity provider has exposure to those risks and they have to through the pool, there is a requirement to really manage the spot change risk and one approach to that is by combining two pools together. One will be with one month, one month tenor, the other one will be one day or 1 hour, some very short term expiries and hedging one with the other how the pool liquidity behaves. So, first of all, we have to think of the pool liquidity nowadays.
00:25:24.296 - 00:25:50.564, Speaker A: So as it is like you store the pool, you provide liquidity of few million USDC for example, and that liquidity is available to ensure the collateralization of any trades that are happening on behalf of traders. But there is also like a future liquidity of the pool that we can think of. Whenever we start trading, then there will be some unsettled forwards that we can start projecting of what the payouts will be.
00:25:50.564 - 00:26:23.520, Speaker A: So we can extrapolate the current lambda calculations, we can calculate how much time to expiry they have and we can plan what really will be the liquidity that will be available for collateralization of the trades that happen afterwards. And the way we calculate the price, the lambda of the AMM is ideally is based on the future liquidity because we want to make sure that the pool doesn't acquire more and more exporters. It cannot really collateralize these positions.
00:26:23.520 - 00:26:51.656, Speaker A: We can use as a proxy now the current liquidity, but ideally we precalculate all of those. Every now and then we can recalculate all the open positions so every single forwarder is open, do the projections on the current lambdas and see what exactly the pull position is. And again, this can be calculated every now and then waveclay resolutions, what we can build on top of it.
00:26:51.656 - 00:27:33.800, Speaker A: So having built this construction, we can also start to do trading of different types of parameters. So we not only can trade lambda, but we can start trading some parameters that are proper representations of the volatility in the market and having had built the forwards construction and the volatility that you would trade, you can start actually recreating the exposures that you have when you trade options. And this starts to properly introduce the basic building blocks for the derivatives market on the protocol and potentially not only on the protocol parameters but later on any digital assets.
00:27:33.800 - 00:28:07.410, Speaker A: And yeah, please visit Alpha Toilet network, please see the binary option solutions and I think the forwards solution should be there pretty soon. I think also there will be a follow up paper like research paper describing this forwards construction coming soon and yeah, we are open to any questions from the audience. It what would be the common use cases for this.
00:28:07.410 - 00:28:31.028, Speaker A: So you can think of the when you think about the hash rate, so this would be miner potentially rolling their position to have the predictable cash flows because with the constant maturity of one month you can simply keep rolling the contract every month. So you enter a long position and then after one month you settle it and you enter another position and so on and so on. So you have a rolling contract.
00:28:31.028 - 00:29:14.456, Speaker A: So it's all about managing cash flows if you have exposure to hash rate, so if you're a minor for the gas price, similarly if you have the exposure to the regular big gas price payments. So think of some exchanges that will have massive withdrawals, like monthly withdrawals, some kind of predictable pattern of withdrawals that they can measure. You can start building some more predictable cash flows, you can hedge your future cost of withdrawals, future cost of gas payments, so there's lots of DeFi protocols that have regular payouts or miners mining pools paying out the rewards among all the pool participants and so on and so on.
00:29:14.456 - 00:29:32.540, Speaker A: So you create the market for all the institutional clients that needs to have more predictable cash flow. So this is what in traditional finance would happen. So you have traditional user of the market which is someone who participates in the operation that is having direct exposure to those parameters.
00:29:32.540 - 00:30:05.160, Speaker A: And as for the deposits, if deposits discrete also in the market of capital market, when you want to move between the floating or fixed exposure between you set up validators and you don't know really how many more validators will be coming to the network. So you want to offset that uncertainty, you want to hedge it and remove it and you say okay, so I know what my cash flows will be from setting up the validators. So you can have a bit more predictable costs for RNG operations and the revenue flow.
00:30:05.160 - 00:30:46.744, Speaker A: Cool, that's good. Do you guys have a token or something? Yeah, actually yes, there is the oil token for the Ole project. Quick question, so this is only about gas prices or hash rates or you aim for wider options, derivatives and all that? Yeah, our niche, our place is everything that is related to protocol.
00:30:46.744 - 00:31:30.552, Speaker A: So things that are measurable on protocol, which would be potentially gas limits like the block sizes, maybe as ethereum two appears, maybe like the health of the sharding solutions, things related to deposits, the health of validators behaviors, how many slashings are happening, gas prices. So many of those parameters will have direct financial effect on operations on many market participants, whether they are like if someone is running a form of validators so like few thousand validators and they want to protect themselves against slashing. So everything that's observable from the chain related to the health of the chain, this is what we want to explore and we want to produce, deliver the products around this.
00:31:30.552 - 00:31:39.944, Speaker A: We're starting with the hash rate, gas prices and validators so not external data fed by Oracles. Yeah. So to avoid any Oracles external.
00:31:39.944 - 00:31:41.550, Speaker A: Okay, got it. Thank you.
00:31:42.080 - 00:31:44.590, Speaker B: So you can as well make an insurance market.
00:31:46.000 - 00:31:57.612, Speaker A: Yeah. So whenever you talk about options derivatives, when you think about hedging the risk, so you start to think that this is insurance market. In a way it's all automated.
00:31:57.612 - 00:32:11.332, Speaker A: So it's not like the mutual insurance as you would see with Nexus. But I know that there are some other solutions with the insurance now that it's more so. Yes, but this is algorithmical hedging your risks.
00:32:11.332 - 00:32:20.552, Speaker A: So in this way it is insurance, but we wouldn't call it insurance. Great talk. I have a question.
00:32:20.552 - 00:32:22.904, Speaker A: Do you have any plans for layer two derivatives?
00:32:22.952 - 00:32:25.276, Speaker B: Like amount of call data posted from.
00:32:25.378 - 00:32:51.152, Speaker A: Let'S say arbitram or optimism to layer one? Yes, this is naturally extending to both the side chains and layer two. So if you think that something works on mainnet, there are some particular parameters that are important for sidechains behaviors. Imagine that you want to participate in some sidechain operations, let it be xdai or other solution.
00:32:51.152 - 00:33:15.304, Speaker A: So you want to make sure that there is no event that would normally be treated as something very risky for the chain. Similarly for the layer two, you may want to try predicting of how popular the layer two behaves. Like start to monitor the amount of settlements of particular protocol on layer one or analyze the batches flowing from layer two.
00:33:15.304 - 00:33:24.112, Speaker A: Whether it's starquare or other solution. Again, it all falls under the scheme. Thank you.
00:33:24.112 - 00:33:35.230, Speaker A: It's.
