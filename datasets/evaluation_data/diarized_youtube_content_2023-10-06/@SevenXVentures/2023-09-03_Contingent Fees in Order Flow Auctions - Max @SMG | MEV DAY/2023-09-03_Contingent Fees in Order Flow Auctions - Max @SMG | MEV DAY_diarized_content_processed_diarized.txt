00:00:02.010 - 00:00:15.514, Speaker A: Thanks for having me. This is very cozy. This is nice. I definitely don't have to shout, you know, it's good. There we go. Thank you. So my name is Max Resnick.
00:00:15.514 - 00:00:59.230, Speaker A: I am the head of research at Special Mechanisms Group, which is Mev research company. This is some work that I did a while ago, actually about six months ago, and at the time it wasn't a reality yet, what we're talking about. But then Uniswap X came out and so immediately it became a lot more relevant. So thanks very much to them for this. So let me just talk a little bit about the parts of Uniswap X that are relevant. A user kind of submits a trade that they want to do. They say, I want to buy some ETH, okay? And then the initial mark on the price is set by an auction.
00:00:59.230 - 00:01:58.580, Speaker A: And whoever wins that auction, whoever gives them the best price, gets an exclusive right to fill that intent. Since we're here at the Intent Hacker house, they get an exclusive right to fill it for two blocks. N equals two, right? Now, who knows what that parameter will be? There's some other stuff that I claim doesn't really matter that much, which is the majority of the rest of the white paper. But for our purposes, we're really focused on this first step, which is set the mark and then the person who wins the auction gets an exclusive right to fill it for two blocks. Okay? So I want to preface this by saying that this is like a subtweet from the future of Alex's Tweet today, which is that execution is not one dimensional. I think in TradFi, because everything happens so fast, we usually think of execution as about price. But if you get executed at a price today versus a price in five days, it's not the same.
00:01:58.580 - 00:02:52.260, Speaker A: So execution is about price. It's also about the time you execute, and it's really about the price at the time you execute, not when you submit the order. So what are we talking about? Let me just set the stage like it's kind of a more general version of what I just talked about with Uniswap X. But somebody comes in with an order, we auction off the right to the order, and then there's two ways we can make the person who wins it pay for the order. Either they pay if and only if they execute, which is actually pretty nice and easy on chain, because you can just put the payment when they execute on chain, or this is a little bit harder to do but has some better properties. You can do an upfront payment, which is you pay for the order if and only if you win it. So I'm maybe old fashioned, but I think if you buy something, then you should pay for it, not when you use it.
00:02:52.260 - 00:03:26.670, Speaker A: If you buy a vacuum cleaner, you don't pay for it. When you plug it in the first time, you pay for it at the store when you buy it. So this is kind of the big breakdown and the big tension that I'm going to talk about today is what happens when your auction is contingent fee based and what happens when it's upfront payment based. Obviously, like I said, contingent fees are actually much easier in practice. So engineers always advocate for them. But you can't let your engineers dominate. The researchers have to come in sometimes and so there is some convenience.
00:03:26.670 - 00:04:02.840, Speaker A: And I think that's probably why uniswap x ended up with this continued fee design because you can make the payment happen on chain. But as we'll see, that has some issues with regards to execution both on the time dimension and on the execution quality dimension. So here's a simple model we're going to ignore the N equals two part. We're going to say N equals one. So there's a single transaction T, it's offered at auction. It's a limit sell order. That means it's selling, say, one unit of ETH at a certain strike price.
00:04:02.840 - 00:04:43.462, Speaker A: The strike price is K, which may be a bit confusing. We call the reference price S, usually in options. And, um, so because the the order is a sell order, the right to execute it is actually an option to buy because it's taking the other side. And so if you execute it, you get the price, the external price which is S minus K, which is the price of the limit order. And I have a graph of what that looks like. So this is just a standard Options 101 graph. I'm going to do a little options detour because we kind of need it for the rest of the talk.
00:04:43.462 - 00:05:29.494, Speaker A: But this is kind of the value of the option down here in this region below the strike price. It's not worth it to execute. So the option is worth zero because it is an option, it's not an obligation up here when the price is 60 and the strike is 50 you get 60 -50 so that's just the line s minus K. So the thing about options is that they're a bet on volatility. So here I have three different probability distributions of where the price is going to go and of course, three different prices for exactly the same option, which anybody who knows option theory will know. But sometimes it's a bit niche. But you can see this one is kind of more spread out.
00:05:29.494 - 00:06:03.070, Speaker A: So there's more volatility. The expected value of this option is higher, that one is much tighter, the expected value is lower. And then this is a really big point that I want everybody to take away from. If you take away from anything from this talk, well this and don't use contingent fees, but contingent fees change the strike of the option, not how much you pay for the option. So this dimension. That's how much you're paying for the option. This dimension is the strike.
00:06:03.070 - 00:06:42.330, Speaker A: So you can see if I have a so I have two types of options here in the red, that's an option at strike 50 with a price of $10. In the blue, that's an option with strike 50, but a conditional execution fee of $10. And it looks like an option at strike 60 with a price of zero. So don't give away free options. Don't use contingent fees. And one more thing on that slide before you just want you to notice that because the strike is now 60, you don't execute unless the price is over 60. So when we care about execution, we care about execution probability as well.
00:06:42.330 - 00:07:08.260, Speaker A: So if you start changing the strike a lot, you're going to lose out on this whole region where the price could be in this range and doesn't execute. So I'm going to do two models. One is going to be the upfront payment auction. One of them is going to be the contingent fee auction. They're going to work exactly like you expect. You're going to have bidders submit bids. The highest bidder is going to win.
00:07:08.260 - 00:07:46.898, Speaker A: And in the upfront payment auction, they're going to pay when they win because they pay upfront. And in the last stage, because this is an option, the winning bidder is going to observe the external price s one and decide whether to execute the transaction or not. And so whoever wins and pays a bid B, their valuation is going to look like this in the upfront payment game. And now in the contingency game, we're very similar. The only difference is I've changed where they're paying. They're paying if they execute. And so now down here, this thing which used to be a minus B is a zero.
00:07:46.898 - 00:08:27.626, Speaker A: So if you just flip back and forth once, you can see that there's very little changing other than when it's paid. And it's changing this little term down here. Okay, so let's start by saying what the equilibrium is in the simple case of the upfront payment gain. How much are you willing to pay for an option? Well, you're willing to pay the expected value of the option. Alex is going to heckle me after for this. But in the paper I use this perfectly competitive auction assumption. And so the Nezlobin critique is that auctions aren't perfectly competitive.
00:08:27.626 - 00:09:08.614, Speaker A: The Pi Rapost molest pi is my co author is that it only takes two people to run an auction. But in this case, we're going to idealize the world in which there's a perfectly competitive auction and that means there's zero profit to be taken here. And so the price that the auction is going to clear at is the value of the option, which is this. Now that's pretty simple. That's kind of how we want it to clear, right? This is the equilibrium in the contingency game. Well, let's start with the payoff for winning before you had a payoff of S one minus K of U one. Now we have this extra V term.
00:09:08.614 - 00:09:33.170, Speaker A: So this is exactly what I showed earlier in the options photo. We're shifting the strike, and that's this term, you're shifting the strike. So now the more you bid, the less you want to execute. Which slide am I? Which slide? This one? Okay. Yeah. You can go to the next one. Yeah.
00:09:33.170 - 00:10:23.538, Speaker A: So now we're going to apply the zero profit condition again, critiques aside. And the first line here is the profit is zero, zero profit condition. So if the zero profit condition holds, then you must never want to execute the option with the adjusted strike price. So you don't ever want to execute, which is bad for execution. And that must mean that the price that you bid is so high that this holds, right? It's so high that the highest possible price that it could end up at is not high enough to make you want to execute. So this is a bit of a degenerate game in some sense. There's so much unraveling that you really never want to execute in this example.
00:10:23.538 - 00:11:12.290, Speaker A: And obviously I chose the model that way. But summarizing what we've learned in the upfront payment game, where you don't have contingent fees, the kind of auction queries for the value of the option, and we don't have any issues. Everything works as expected in the contingent fee game, we have a ton of unraveling, and so we have the bid coming up way high. The order is not executing, and there's no revenue because you only get revenue when it executes, right? It's contingent on execution. Okay, so that model was a bit degenerate because there was too much unraveling. So let's introduce a mixture parameter. So we're going to mix the two.
00:11:12.290 - 00:12:01.570, Speaker A: The reason I do this is because a lot of people like to do reputation systems, including uniswap. And so there is still a penalty for not executing, but the penalty is maybe not exactly the right amount. And so that's what the mixture looks like. So you still have some penalty as a function of your bid, but it's not exactly the whole bid. And so we're going to see what this looks like. So this is like some math salad up here, but if you're working with multiply, then this ends up making sense somehow. But this is I mean, I couldn't simplify it anymore because there's no analytic solution in general, but I just use a computer program to solve this.
00:12:01.570 - 00:13:13.130, Speaker A: So I use a bracketing zero finder to solve this, and I get B star, which we're going to use later on. So what's the probability of execution? Just the probability that the price is high enough that you want to execute. And these are kind of all the things we care about. These next three slides are like the things that we care about probability of execution, auction revenue, and alex's favorite execution quality. So this is going to be our equation for auction revenue. And don't worry, I have pictures later so we don't have to kind of do this math out and the effective spread, which is the execution quality at the time that it executes, so I have pictures so we don't have to go through all this. But this is my summary of what the pictures are about to show you, which is the closer you are to an upfront payment auction, meaning the closer alpha is to one, the more often you execute, the more auction revenue you get and the better your effective spread is for users.
00:13:13.130 - 00:13:50.054, Speaker A: So here's an example of just this plotted with kind of the volatility being this uniform zero one. So the price ends up being between zero and one. The strike is 0.5. You can see bids are coming down, which is what we'd expect because remember, bids being too high over here was why there was unraveling. Probability of execution is coming up. As we said in the theorem, effective spread is coming down, which is good, and auction revenue is going up good. I have a few more.
00:13:50.054 - 00:14:50.762, Speaker A: So maybe you're not convinced by the uniform distribution here's a bunch of other PDFs, not uniform, all with the same pattern. And of course there's a proof in the paper if you are still not convinced by this. Okay, so let me just talk a little bit about reputation systems because I think a lot of the answer to this critique is, hey, we'll just have a reputation system and that'll make it so they don't want to play this kind of game and it doesn't unravel. So like I said, mixed. Your model is kind of a good model of this, but you still saw we had some unraveling if we get it wrong. And in fact, if you make your reputation system penalize too much, then you kind of have the other problem, which is that it can make you want to bid too little and that can also hurt revenue. So you really want to get your reputation almost exactly right so that the incentives look like an upfront payment game, in which case just do the upfront payment game.
00:14:50.762 - 00:16:05.502, Speaker A: Don't fool around with this reputation system, don't have permission stuff, don't have to do a bunch of calibration, just do that front payment game. Okay, another extension that you might want to add is, hey, maybe there's no PBS auction in the block or maybe somebody gets your order and they execute it regardless of whether you want it, right? Well, I claim that with the probability of involuntary execution and probability of involuntary failure together, less than one, so you still have some choice, basically is what that means. Then you still have a very similar model with it just a different mixture parameter alpha. Just set it according to the parameters and it kind of works out and you have all the same results. Obviously it's going to be different alpha, so it's going to be a different degree of unraveling, but you have a lot of the same results. I just want to thank flashbots funded this with a research grant and then I talked a lot with Quintus and Aleja about the results. And I also want to thank Uniswap for making my research relevant by releasing an LFA that did not follow my guidelines.
00:16:05.502 - 00:16:06.420, Speaker A: Thank you.
00:16:10.790 - 00:16:16.130, Speaker B: Thank you so much. And before delving into the Q A section, since Alex is a related expert.
00:16:19.990 - 00:16:56.782, Speaker C: I'm trying to do little auction theory research, but I think that it's one thing that one has to be careful in particular application with Uniswap, right. It's pretty difficult for them to implement an upfront payment. How exactly would it look? Because the other party has the last look as well. So if you submitted something to Uniswap, somebody wins the bid. Now they have to pay according to this mechanism. But the person who initially submitted the swap always has the option to front run the filler and just evoke permit two privileges or something.
00:16:56.836 - 00:16:57.018, Speaker A: Right.
00:16:57.044 - 00:17:40.702, Speaker C: So in this game, it's a little tricky to implement. I noticed that in one of the last slides you had a situation where there is a probability of failure, but here the probability of failure is actually linked to the price. If I observe that the price moved against me, I can cancel and revoke, and so there is a fixed cost for me of doing so. Or maybe it's not fixed because it will go to the builder eventually, right, because the builder will see that I want to cancel and then the filler is now racing against me. Get that fill, because they already paid for the right to fill. And so I think that then we basically end up in the game of mev between the filler and the client. I don't expect that to happen very often, to be honest, but it might.
00:17:40.702 - 00:18:01.846, Speaker C: And so I think it would be interesting to have, now that Uniswap made your research relevant, to push it a little bit further in the direction of sort of looking at what they're doing actually, right now, what they can do and see if you can push the research a little bit further and make predictions sort of that are useful for their specific.
00:18:02.028 - 00:18:59.740, Speaker A: Yeah, this is like an interesting point. I think it also is an interesting point to bring up that half of blocks are built by bidders in the Uniswap auction. Yeah. So they have a little bit of extra power in terms of that censorship game, kind of like race. I also think a lot of the point of this is how do we provide good execution to retail users? And so I'm not trading against Alex, Ms Loeb, and necessarily I'm trading against random Uniswap user who probably doesn't care enough to cancel their order or doesn't have the monitoring available to check the finance price moved against them, and now I'm going to cancel. So in some ways there's that asymmetric sophistication there's an asymmetric structural advantage for the people biding in the auction building 50% of the blocks, which is also something that can sometimes be used to your advantage when censorship concerns go against you.
00:19:02.510 - 00:19:11.210, Speaker B: Okay, then. Q and a session begins. Any questions from the audience? Okay then, if you're too shy.
00:19:12.530 - 00:19:35.300, Speaker D: Yeah, I came in sort of late, so I apologize, but you mentioned how reputation systems are detrimental to the option and so typically I think they're used to avoid dos. So I was wondering, could you expand a bit about how you were referencing the reputation system?
00:19:36.070 - 00:20:18.660, Speaker A: Well, the way it would work is you have a reputation that gets penalized if you don't execute. And so it kind of looks more like the mixture game. So I think reputations can be helpful in solving this problem and solving some of the unraveling. And I think on uniswap, there's not a live reputation system right now, but there's kind of an implicit thing like don't do bad stuff to our users or you're going to get kicked off the whitelist. As far as that's kind of how I'm thinking of reputation system, and I think as well, how the uniswap team is thinking of reputation system is in terms of actually solving this problem, like putting in reputation penalties for not executing user orders because the price moved against you.
00:20:21.350 - 00:20:24.610, Speaker D: Is your goal zero profit for the validator?
00:20:28.930 - 00:20:30.206, Speaker A: The question is, is there any benefit.
00:20:30.238 - 00:20:32.260, Speaker D: To having it a little bit above zero?
00:20:33.190 - 00:21:12.960, Speaker A: So I guess I give the zero profit condition because that's what it would be in a competitive auction. It's not a competitive auction in a lot of cases. We actually have some work coming out about this, about what the competition looks like in Sextex arbitrage. There's quite a few players who are pretty sophisticated. Not all of them have builders, which is a big part of this. I think our goal isn't to make the profit go to zero. I think our goal is to avoid unraveling that actually takes away from the sum total of value created by the system.
00:21:12.960 - 00:21:47.260, Speaker A: And like I showed in my kind of stylized model, if you have unraveling, you can have a system that just doesn't work at all in that you're just executing orders, like way too rarely and you're executing them at prices that users don't want. So you're kind of getting rid of the individual rationality in the whole system that nobody even wants to participate anymore. Separately, I think that validators are making quite a bit of money, but that's not necessarily related to this discussion. Yeah.
00:21:50.030 - 00:22:03.050, Speaker B: Any more questions? Yeah. And then we will break into a small break for about 15 minutes. And if you want to discuss with Max, just come to him. And the next speaker is Dan from flashboard.
00:22:06.430 - 00:22:07.440, Speaker A: Thank. Um.
