00:00:09.530 - 00:00:46.390, Speaker A: Okay. All right, sounds good. Everyone, thank you so much all for coming. We are now live and kind of going live at hello, I'm Peep Sean On. I'm one of the ETH Global team members, guys. And I'm honored to be joined here by crypto Rachel, who's going to give us a rundown of single sided liquidity pools from polls from Uniswap. And I ask that everyone kind of save your questions till the end, and if you have any questions, do feel free to kind of reach out in the zoom chat.
00:00:46.390 - 00:00:56.110, Speaker A: And yeah, everyone, please also keep your mic off while the presentation is going on. And without further ado, I'm going to pass back to Rachel for this wonderful presentation.
00:00:56.770 - 00:01:02.240, Speaker B: Hi, everyone. So just make sure everyone can see my screen.
00:01:05.010 - 00:01:06.160, Speaker A: You're coming in.
00:01:06.630 - 00:01:58.174, Speaker B: Is my mouse there so I know if they can see where I'm pointing? Yep. Okay, just sorry. All right, everyone, so my name is Critical Rachel. I've been helping out in the Uniswap discord for about a year now. A while ago, we had a lot of users with ample that got stuck in V Three, and I wanted to help them get it out. So I delved pretty heavily into the V Three contracts, and I came up with this. I'm just going to go over quick few things with the interfaces just to describe the setup so you know what's in the contract.
00:01:58.174 - 00:03:23.802, Speaker B: As I'm speaking about it, I've got the interface for standard IERC 20 for the balance and transfer, the NFT received interface, an IERC 721 interface, the router interface for the V Three router, and of course, some safe mask skipped into the bottom. Just some stuff I added in for safety. Able to kill the contract if it didn't work, returning an NFT if somebody made a mistake or tokens if somebody made a mistake and a withdrawal for east collected for the reward. And that brings us back to the main function. It's pretty simple. Starting here is the main one, I call got to approve the NFT for transfer. Although technically I could have left out the transfer from but I didn't realize this till recently.
00:03:23.802 - 00:04:23.120, Speaker B: After it was made. Only would have saved some gas, really. And then I call on the position ID for the available liquidity. From there, I encode the amount of the liquidity that's in the person's pool, the NFT and the amount out minimum and amount one minimum. For the tokens, I actually set to max. If you can see here, I set it to a max. You went 128 or 128.
00:04:23.120 - 00:06:09.530, Speaker B: This allows me to close out the whole position, whether it's a good token, a bad token, and the ETH that it's paired with or any other token it's paired with. From there, I wrapped that with the actual bytes for call function for collect or decreasing liquidity. This is the actual call data. For whatever reason, it only wanted to accept it packed. Sorry. Water so I ended up trying all the others but only packed would work. Once I got the pack to work, I call and close the position with the V three contract, the NFT positions contract and that's the function code, make sure that it actually happens and then I call the next function I had to separate due to stack too deep.
00:06:09.530 - 00:08:50.954, Speaker B: These returns are for the returning of the NFT which I put this if in there so I could collect a second half with only this single function after the position was already closed. Once the position is closed you can call the collect because it takes all of the liquidity and moves it to your amount token node. For this you need the NFT ID, the address where the liquidity is going which I'm pulling here to collect the reward and the amount out max and amount out one max was set to zero because you don't need to worry about anything because it's already in the collective position. Sorry. 1 second. And once again, I did have to pack that data into just a straight call, which this function signature is the collect. And once I do the packing, I actually call it and decode the returned amounts of tokens here, I just make sure that one of the two came back so as to save guess if any errors in polling to see which one came back with actual token.
00:08:50.954 - 00:10:32.130, Speaker B: This allows me to do one at a time. It, but still have the option to do them both at a later point in time if it's not so much a problem with the token but most of the time the token gets locked the ample because it's a rebase the balance in the actual pool contract will go up and down. This allows me to pull their ample at a future point if it rebases in the contract's favor then I do the fee amount which is 10%. I do have it set internally up here. Once I do that I set the user's address as payable so I can send them the Wies or ETH or token. If it is ETH that comes back through. I have a switch on the website for bull if they want to receive ETH instead of we.
00:10:32.130 - 00:11:36.696, Speaker B: So if they want to receive ETH, it'll come down here, make sure the token is in, we withdraw it, make sure that nothing happened, and then transfer the amount minus the fee to the user, else it'll safe. Transfer the token. Just a safety, probably doesn't need to be there. And the other else is to transfer any other token and once again return the NFT ID. Once done. And that is right here, an internal safe transfer film. So basically I'll go over it.
00:11:36.696 - 00:13:05.510, Speaker B: Now in a rougher version this allows any user to close their position despite whether a token pair is locked up isn't enough in the pool contract like ample or if a Fion transfer breaks the pool in some way. It will work for a broken pool, too, but it closes the position and moves all the tokens into the amount tokens owed of the position ID of the owner of the NFT. And this allows you to collect only one of them at a time for instances where you can't transfer a token or there's not enough in the contract to actually pay the owed. I'm thinking that's about it. Maybe we can jump into some questions.
00:13:08.280 - 00:13:11.110, Speaker A: Sure thing. Anyone got any questions?
00:13:30.280 - 00:13:33.088, Speaker B: I just found the chat. Sorry.
00:13:33.274 - 00:13:36.196, Speaker A: Yeah, everyone's sending you quite a lot of good compliments.
00:13:36.388 - 00:13:37.610, Speaker B: Well, thank you.
00:13:38.380 - 00:13:40.712, Speaker A: Yeah, this is good.
00:13:40.766 - 00:13:49.492, Speaker B: Good job. Yes, dave, that's the function? Yep.
00:13:49.556 - 00:13:55.550, Speaker A: All right, sounds good. I wanted to do just another call for questions, and if not, I guess we can.
00:13:56.560 - 00:14:45.710, Speaker B: Did you have anything? Honestly, I didn't go back and rehash over. Why? It wouldn't let me. The only thing I was thinking had something to do with the multi calls, but I did try it unpacked. I tried calling it with just decreased liquidity through an interface rather than raw like I had to. So unfortunately, I don't know why I had to pack it. I just know it worked. Of course, I should look into that.
00:14:45.710 - 00:15:46.240, Speaker B: What I did to figure it out is I took an actual transaction that did a full liquidity pool, and I used the actual data to rebuild exactly what I needed. So it became a little rough contract. And I do want to relaunch, because I could save probably half, a little less than half, just by removing the safe transfer from for the NFT ID. Because once they actually approve the contract, the contract can do the liquidity pull without transferring into the contract.
00:15:51.780 - 00:16:04.676, Speaker A: Sounds good. Anyone else? Benson wants a high level explanation on.
00:16:04.698 - 00:18:19.060, Speaker B: What this is about, so I started with the ample weath pool. Ample is a rebase token, so every day the balance of the contract or the holder changes. Therefore, if you try to pull liquidity from the uniswap website, it doesn't allow because it doesn't see the ample tokens in the contract. So the safe transfer fails due to not having tokens of ample noise. This allows a bypass of the need to interact with the token, because in this instance, the ample can't be transferred, but the we or ease can. And once you change a position from open to close, you have the ability to only take out one of those tokens. If you can give me something more specific, I'll go into details about that's.
00:18:19.060 - 00:20:01.660, Speaker B: Benson, did you have another oh, there you yeah, let me share the contract's address. It's all there. It's public contract, and I'm around a lot to help with questions, perhaps any other questions? Benson got nine minutes left. I could always do a quick synopsis of my scam contracts to recover scam token money. Okay, that's perfect question. So these three will not work right. With fiat transfer tokens, rebase token, and reflection tokens.
00:20:01.660 - 00:21:09.330, Speaker B: It happens because the token balances change. So if there's not enough of one token in the contract, you're unable to pull either liquidity. And this also works for tokens that break for whatever reason, get locked, unable to transfer due to a bad code. This will allow to get the Weatheath or other half of the pair tether any major coin out of the pool. Yes. Yeah. So you can recover the wheat if the token is locked still with V three.
00:21:09.330 - 00:21:51.470, Speaker B: Benson correct. This is about the imbalance mostly. At least that's what it started with. Basically, it'll work on any pool, and this allows you to pull the main half with value. Like a couple of people broke their tokens and couldn't even transfer, buy, sell anything with the pool. This was able to recover their weave so they could start over.
00:22:04.140 - 00:22:36.944, Speaker A: Thanks for the question. Benson I guess just to kind of wrap everything up here, I want to kind of just tell everyone, hey, do feel free to reach out to, you know, we really appreciate this presentation, and I'm sure that she would be completely she'd be very happy to kind of give you all some more pointers. If you have any questions, be sure to kind of consult her on this poll strategy, and then we can take it from there. Thanks so much.
00:22:37.142 - 00:22:40.140, Speaker B: Thanks, everyone. You have a good day. Bye.
